<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.returnp.admin.dao.mapper.SearchMapper">
  
  <select id="selectTotalRecords" resultType="int">
     select found_rows();
  </select> 
  <sql id ="commonStatement">
   	<choose>
   	<when test="order !=null">
		order by ${order} 
	</when>
	<otherwise>
		order by createTime desc
	</otherwise>
	</choose>
	<if test="pagination">
		limit ${pageSize} offset ${offset}
	</if>
  </sql>
  <!-- ===============================================================================================================    -->
  <!-- Admin Mapper   -->
  
    <resultMap id="AdminResultMap" type="com.returnp.admin.model.Admin">
    <id column="adminNo" jdbcType="INTEGER" property="adminNo" />
    <result column="adminName" jdbcType="VARCHAR" property="adminName" />
    <result column="adminEmail" jdbcType="VARCHAR" property="adminEmail" />
    <result column="adminPassword" jdbcType="VARCHAR" property="adminPassword" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  <sql id="Admin_Column_List">
    adminNo, adminName, adminEmail, adminPassword, regAdminNo, createTime, updateTime
  </sql>
  
    <sql id ="adminWhereStatement">
	 <if test="adminNo != null  and  adminNo  != 0"> AND adminNo = #{adminNo} </if>
      <if test="adminName!= null"> AND adminName =  #{adminName} </if>
      <if test="adminEmail != null"> AND adminEmail =  #{adminEmail} </if>
      <if test="adminPassword != null"> AND adminPassword = #{adminPassword}</if>
      <if test="regAdminNo != null and regAdminNo != 0"> AND regAdminNo = #{regAdminNo} </if> 
	</sql>
	
  <select id="findAdmins" parameterType="com.returnp.admin.model.Admin"  resultMap="AdminResultMap" >
    select 
    <include refid="Admin_Column_List" />
    from admin
    where 
    	1 = 1
		<include refid = "adminWhereStatement"/>
  </select>
  
  
  <!-- ===============================================================================================================    -->
  <!-- Policy  -->
    <resultMap id="PolicyResultMap" type="com.returnp.admin.model.Policy">
    <id column="policyNo" jdbcType="INTEGER" property="policyNo" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="branchComm" jdbcType="REAL" property="branchComm" />
    <result column="soleDistComm" jdbcType="REAL" property="soleDistComm" />
    <result column="agancyComm" jdbcType="REAL" property="agancyComm" />
    <result column="affiliateComm" jdbcType="REAL" property="affiliateComm" />
    <result column="branchRecComm" jdbcType="REAL" property="branchRecComm" />
    <result column="agancyRecComm" jdbcType="REAL" property="agancyRecComm" />
    <result column="affiliateRecComm" jdbcType="REAL" property="affiliateRecComm" />
    <result column="customerRecCom" jdbcType="REAL" property="customerRecCom" />
    <result column="customerComm" jdbcType="REAL" property="customerComm" />
    <result column="pointTransRate" jdbcType="REAL" property="pointTransRate" />
    <result column="pointTransLimit" jdbcType="REAL" property="pointTransLimit" />
    <result column="redPointAccRate" jdbcType="REAL" property="redPointAccRate" />
    <result column="membershipTransLimit" jdbcType="INTEGER" property="membershipTransLimit" />
    <result column="gPointMovingMinLimit" jdbcType="INTEGER" property="gPointMovingMinLimit" />
    <result column="gPointMovingMaxLimit" jdbcType="INTEGER" property="gPointMovingMaxLimit" />
    <result column="rPointMovingMinLimit" jdbcType="INTEGER" property="rPointMovingMinLimit" />
    <result column="rPointMovingMaxLimit" jdbcType="INTEGER" property="rPointMovingMaxLimit" />
    <result column="customerRecManagerComm" jdbcType="REAL" property="customerRecManagerComm" />
    <result column="affiliateRecManagerComm" jdbcType="REAL" property="affiliateRecManagerComm" />
    <result column="agancyRecManagerComm" jdbcType="REAL" property="agancyRecManagerComm" />
    <result column="branchRecManagerComm" jdbcType="REAL" property="branchRecManagerComm" />
    <result column="rPayWithdrawalMaxLimit" jdbcType="INTEGER" property="rPayWithdrawalMaxLimit" />
    <result column="rPayWithdrawalMinLimit" jdbcType="INTEGER" property="rPayWithdrawalMinLimit" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  <sql id="Policy_Column_List">
    policyNo, regAdminNo, branchComm, soleDistComm, agancyComm, affiliateComm, branchRecComm, 
    agancyRecComm, affiliateRecComm, customerRecCom, customerComm, pointTransRate, pointTransLimit, 
    redPointAccRate, membershipTransLimit, gPointMovingMinLimit, gPointMovingMaxLimit, 
    rPointMovingMinLimit, rPointMovingMaxLimit, customerRecManagerComm, affiliateRecManagerComm, 
    agancyRecManagerComm, branchRecManagerComm, rPayWithdrawalMinLimit, rPayWithdrawalMaxLimit, createTime, updateTime
  </sql>
  
  <sql id ="policyWhereStatement">
	 <if test="policyNo != null  and  policyNo  != 0"> AND adminNo = #{adminNo} </if>
      <if test="regAdminNo != null and regAdminNo != 0"> AND regAdminNo = #{regAdminNo} </if> 
	</sql>
	
   <select id="findPolicies" parameterType="com.returnp.admin.model.Policy" resultMap="PolicyResultMap">
    select 
    <include refid="Policy_Column_List" />
    from policy
    where 
    		1 = 1
		<include refid = "policyWhereStatement"/>
  </select>
   
   <!-- ===============================================================================================================    -->
   <!-- Member  -->  
	<resultMap id="MemberResultMap" type="com.returnp.admin.model.Member">
    <id column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberPassword" jdbcType="VARCHAR" property="memberPassword" />
    <result column="memberPassword2" jdbcType="VARCHAR" property="memberPassword2" />
    <result column="memberType" jdbcType="VARCHAR" property="memberType" />
    <result column="memberStatus" jdbcType="VARCHAR" property="memberStatus" />
    <result column="memberAuthType" jdbcType="VARCHAR" property="memberAuthType" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="joinRoute" jdbcType="VARCHAR" property="joinRoute" />
    <result column="statusReason" jdbcType="VARCHAR" property="statusReason" />
     <result column="isSoleDist" jdbcType="CHAR" property="isSoleDist" />
    <result column="isRecommender" jdbcType="CHAR" property="isRecommender" />
    <result column="isSaleManager" jdbcType="CHAR" property="isSaleManager" />
    <result column="isBranch" jdbcType="CHAR" property="isBranch" />
    <result column="isAffiliate" jdbcType="CHAR" property="isAffiliate" />
    <result column="isAgency" jdbcType="CHAR" property="isAgency" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
    <resultMap id="MemberCommandResultMap" type="com.returnp.admin.dto.command.MemberCommand">
    <id column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberPassword" jdbcType="VARCHAR" property="memberPassword" />
    <result column="memberPassword2" jdbcType="VARCHAR" property="memberPassword2" />
    <result column="memberType" jdbcType="VARCHAR" property="memberType" />
    <result column="memberStatus" jdbcType="VARCHAR" property="memberStatus" />
    <result column="memberAuthType" jdbcType="VARCHAR" property="memberAuthType" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="recommenderEmail" jdbcType="VARCHAR" property="recommenderEmail" />
    <result column="recommenderName" jdbcType="VARCHAR" property="recommenderName" />
    <result column="joinRoute" jdbcType="VARCHAR" property="joinRoute" />
    <result column="statusReason" jdbcType="VARCHAR" property="statusReason" />
     <result column="isSoleDist" jdbcType="CHAR" property="isSoleDist" />
    <result column="isRecommender" jdbcType="CHAR" property="isRecommender" />
    <result column="isSaleManager" jdbcType="CHAR" property="isSaleManager" />
    <result column="isBranch" jdbcType="CHAR" property="isBranch" />
    <result column="isAffiliate" jdbcType="CHAR" property="isAffiliate" />
    <result column="isAgency" jdbcType="CHAR" property="isAgency" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="greenPointAmount" jdbcType="REAL" property="greenPointAmount" />
    <result column="redPointAmount" jdbcType="REAL" property="redPointAmount" />
  </resultMap>
  
  
    <sql id="Member_Column_List">
   memberNo, memberName, memberEmail, memberPassword, memberPassword2,memberType, memberStatus, 
    memberAuthType, memberPhone, recommenderNo, joinRoute, statusReason, isSoleDist, 
    isRecommender, isSaleManager, isBranch, isAffiliate, isAgency, regType, regAdminNo, 
    greenPointAccStatus, redPointAccStatus, greenPointUseStatus, redPointUseStatus, createTime, 
    updateTime
  </sql>
  
   <sql id="MemberCommand_Column_List">
   M.memberNo, 
   M.memberName, 
   M.memberEmail, 
   M.memberPassword, 
   M.memberPassword2, 
   M.memberType, 
   M.memberStatus, 
   M.memberAuthType,
   M.memberPhone, 
   M.recommenderNo,
   M.joinRoute, 
   M.statusReason, 
   M.isSoleDist, 
   M.isRecommender, 
   M.isSaleManager, 
   M.isBranch, 
   M.isAffiliate,
   M.isAgency, 
   M.regType, 
   M.regAdminNo, 
   M.greenPointAccStatus,
   M.redPointAccStatus,
   M.greenPointUseStatus,
   M.redPointUseStatus,
   M.createTime, 
   M.updateTime,
   M2.memberName as recommenderName,
   M2.memberEmail as recommenderEmail,
   GP.pointAmount as greenPointAmount, 
   RP.pointAmount as redPointAmount
  </sql>
  
    <sql id ="memberSearchWhereStatement">
       <if test="memberNo != null">AND  memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="memberPassword != null"> AND memberPassword = #{memberPassword,jdbcType=VARCHAR}</if>
      <if test="memberPassword2 != null">AND  memberPassword2 = #{memberPassword2,jdbcType=VARCHAR}</if>
      <if test="memberPhone != null">AND  memberPhone = #{memberPhone,jdbcType=VARCHAR}</if>
      <if test="memberType != null">AND  memberType = #{memberType,jdbcType=VARCHAR}</if>
      <if test="memberStatus != null and memberStatus !=  '0'  and memberStatus !=  0">AND  memberStatus = #{memberStatus,jdbcType=VARCHAR}</if>
      <if test="memberAuthType != null">AND  memberAuthType = #{memberAuthType,jdbcType=VARCHAR}</if>
      <if test="recommenderNo != null">AND  recommenderNo = #{recommenderNo,jdbcType=INTEGER}</if>
      <if test="joinRoute != null">AND  joinRoute = #{joinRoute,jdbcType=VARCHAR}</if>
      <if test="isSoleDist != null">AND  isSoleDist = #{isSoleDist,jdbcType=CHAR}</if>
      <if test="isRecommender != null">AND  isRecommender = #{isRecommender,jdbcType=CHAR}</if>
      <if test="isSaleManager != null"> isSaleManager = #{isSaleManager,jdbcType=CHAR}</if>
      <if test="isBranch != null">AND  isBranch = #{isBranch,jdbcType=CHAR}</if>
      <if test="isAffiliate != null">AND  isAffiliate = #{isAffiliate,jdbcType=CHAR}</if>
      <if test="isAgency != null">AND  isAgency = #{isAgency,jdbcType=CHAR}</if>
      <if test="regType != null">AND  regType = #{regType,jdbcType=CHAR}</if>
      <if test="regAdminNo != null">AND  regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="greenPointAccStatus != null">AND  greenPointAccStatus = #{greenPointAccStatus,jdbcType=CHAR}</if>
      <if test="redPointAccStatus != null">AND  redPointAccStatus = #{redPointAccStatus,jdbcType=CHAR}</if>
      <if test="greenPointUseStatus != null">AND  greenPointUseStatus = #{greenPointUseStatus,jdbcType=CHAR}</if>
      <if test="redPointUseStatus != null">AND  redPointUseStatus = #{redPointUseStatus,jdbcType=CHAR}</if>
      <if test="memberName != null or memberEmail != null or statusReason != null">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">OR memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null">OR memberEmail  LIKE CONCAT('%',#{memberEmail},'%' ) </if>
      <if test="statusReason != null">OR  statusReason = #{statusReason,jdbcType=VARCHAR}</if>
      <if test="memberName != null or memberEmail != null or statusReason != null">
      	)
      </if>
	</sql>
	
    <sql id ="memberCommandSearchWhereStatement">
       <if test="memberNo != null">AND  M.memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="memberPassword != null"> AND M.memberPassword = #{memberPassword,jdbcType=VARCHAR}</if>
      <if test="memberPassword2 != null">AND  M.memberPassword2 = #{memberPassword2,jdbcType=VARCHAR}</if>
      <if test="memberType != null">AND  M.memberType = #{memberType,jdbcType=VARCHAR}</if>
      <if test="memberStatus != null and memberStatus !=  '0'  and memberStatus !=  0">AND  M.memberStatus = #{memberStatus,jdbcType=VARCHAR}</if>
      <if test="memberAuthType != null">AND  M.memberAuthType = #{memberAuthType,jdbcType=VARCHAR}</if>
      <if test="memberPhone != null">AND  M.memberPhone = #{memberPhone,jdbcType=VARCHAR}</if>
      <if test="recommenderNo != null">AND  M.recommenderNo = #{recommenderNo,jdbcType=INTEGER}</if>
      <if test="joinRoute != null">AND  M.joinRoute = #{joinRoute,jdbcType=VARCHAR}</if>
      <if test="isSoleDist != null">AND  M.isSoleDist = #{isSoleDist,jdbcType=CHAR}</if>
      <if test="isRecommender != null">AND  M.isRecommender = #{isRecommender,jdbcType=CHAR}</if>
      <if test="isSaleManager != null"> M.isSaleManager = #{isSaleManager,jdbcType=CHAR}</if>
      <if test="isBranch != null">AND  M.isBranch = #{isBranch,jdbcType=CHAR}</if>
      <if test="isAffiliate != null">AND  M.isAffiliate = #{isAffiliate,jdbcType=CHAR}</if>
      <if test="isAgency != null">AND  M.isAgency = #{isAgency,jdbcType=CHAR}</if>
      <if test="regType != null">AND  M.regType = #{regType,jdbcType=CHAR}</if>
      <if test="regAdminNo != null">AND  M.regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="greenPointAccStatus != null">AND  M.greenPointAccStatus = #{greenPointAccStatus,jdbcType=CHAR}</if>
      <if test="redPointAccStatus != null">AND  M.redPointAccStatus = #{redPointAccStatus,jdbcType=CHAR}</if>
      <if test="greenPointUseStatus != null">AND  M.greenPointUseStatus = #{greenPointUseStatus,jdbcType=CHAR}</if>
      <if test="redPointUseStatus != null">AND  M.redPointUseStatus = #{redPointUseStatus,jdbcType=CHAR}</if>
      <if test="memberName != null or memberEmail != null or statusReason != null">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">OR M.memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null">OR M.memberEmail  LIKE CONCAT('%',#{memberEmail},'%' ) </if>
      <if test="memberPhone != null">OR M.memberPhone  LIKE CONCAT('%',#{memberPhone},'%') </if>
      <if test="statusReason != null">OR  M.statusReason = #{statusReason,jdbcType=VARCHAR}</if>
      <if test="memberName != null or memberEmail != null or statusReason != null">
      	)
      </if>
	</sql>
	
 <select id="findMembers" parameterType="com.returnp.admin.model.Member"  resultMap="MemberResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="Member_Column_List" />
    from member
    where 
    	1 = 1
		<include refid = "memberSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
 <select id="findMemberCommands" parameterType="com.returnp.admin.dto.command.MemberCommand"  resultMap="MemberCommandResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="MemberCommand_Column_List" /> 
  from member as M  
    inner join red_point as RP on (M.memberNo = RP.memberNo)
    inner join green_point as GP on (M.memberNo = GP.memberNo AND GP.nodeType ='1' )
    left outer join member as M2 on (M.recommenderNo = M2.memberNo)
    where 
      1 = 1
		<include refid = "memberCommandSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>    

 <select id="selectMemberCount"  resultType="int" >
    select 
	count(*)
  from member as M  
    inner join red_point as RP on (M.memberNo = RP.memberNo)
    inner join green_point as GP on (M.memberNo = GP.memberNo AND GP.nodeType ='1' )
    left outer join member as M2 on (M.recommenderNo = M2.memberNo)
    where 
      1 = 1
		<include refid = "memberCommandSearchWhereStatement"/>
  </select>    
  <!-- ===============================================================================================================    -->
    <!-- SoleDist -->
   <resultMap id="soleDist_ResultMap" type="com.returnp.admin.model.SoleDist">
    <id column="soleDistNo" jdbcType="INTEGER" property="soleDistNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="soleDistCode" jdbcType="VARCHAR" property="soleDistCode" />
    <result column="soleDistEmail" jdbcType="VARCHAR" property="soleDistEmail" />
    <result column="soleDistName" jdbcType="VARCHAR" property="soleDistName" />
    <result column="soleDistAddress" jdbcType="VARCHAR" property="soleDistAddress" />
    <result column="soleDistTel" jdbcType="VARCHAR" property="soleDistTel" />
    <result column="soleDistPhone" jdbcType="VARCHAR" property="soleDistPhone" />
    <result column="soleDistStatus" jdbcType="VARCHAR" property="soleDistStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updatetime" jdbcType="TIMESTAMP" property="updatetime" />
  </resultMap>
  
    <resultMap id="soleDistCommand_ResultMap" type="com.returnp.admin.dto.command.SoleDistCommand">
    <id column="soleDistNo" jdbcType="INTEGER" property="soleDistNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="soleDistCode" jdbcType="VARCHAR" property="soleDistCode" />
    <result column="soleDistEmail" jdbcType="VARCHAR" property="soleDistEmail" />
    <result column="soleDistName" jdbcType="VARCHAR" property="soleDistName" />
    <result column="soleDistAddress" jdbcType="VARCHAR" property="soleDistAddress" />
    <result column="soleDistTel" jdbcType="VARCHAR" property="soleDistTel" />
    <result column="soleDistPhone" jdbcType="VARCHAR" property="soleDistPhone" />
    <result column="soleDistStatus" jdbcType="VARCHAR" property="soleDistStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updatetime" jdbcType="TIMESTAMP" property="updatetime" />
    <result column="greenPointAmount" jdbcType="REAL" property="greenPointAmount" />
    <result column="redPointAmount" jdbcType="REAL" property="redPointAmount" />
  </resultMap>
  
  <sql id="soleDist_Column_List">
    soleDistNo, memberNo, soleDistCode, soleDistEmail, soleDistName, soleDistAddress, 
    soleDistTel, soleDistPhone, soleDistStatus, regType, regAdminNo, greenPointAccStatus, 
    redPointAccStatus, greenPointUseStatus, redPointUseStatus, createTime, 
    updatetime
  </sql>
  
   <sql id="soleDistCommand_Column_List">
   	M.memberEmail as memberEmail, 
    M.memberName as memberName, 
    SD.soleDistNo as soleDistNo, 
    SD.memberNo as memberNo, 
    SD.soleDistCode as soleDistCode, 
    SD.soleDistEmail as soleDistEmail, 
    SD.soleDistName as soleDistName, 
    SD.soleDistAddress as soleDistAddress, 
    SD.soleDistTel as soleDistTel, 
    SD.soleDistPhone as soleDistPhone, 
    SD.soleDistStatus as soleDistStatus, 
    SD.regType as regType, 
    SD.regAdminNo as regAdminNo, 
    SD.greenPointAccStatus as greenPointAccStatus, 
    SD.redPointAccStatus as redPointAccStatus, 
    SD.greenPointUseStatus as greenPointUseStatus, 
    SD.redPointUseStatus as redPointUseStatus, 
    SD.createTime as createTime, 
    SD.updateTime as updateTime, 
    GP.pointAmount as greenPointAmount, 
    RP.pointAmount as redPointAmount
  </sql>
  
 
   <sql id ="soleDistSearchWhereStatement">
       <if test="soleDistNo != null and soleDistNo !=  '0'  and soleDistNo !=  0"> AND soleDistNo = #{soleDistNo,jdbcType=INTEGER} </if>
       <if test="memberNo != null and memberNo !=  '0'  and memberNo !=  0"> AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="soleDistStatus != null and soleDistStatus !=  '0'  and soleDistStatus !=  0"> AND soleDistStatus = #{soleDistStatus,jdbcType=VARCHAR}  </if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null  and regAdminNo !=  '0'  and regAdminNo !=  0"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=CHAR} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=CHAR} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=CHAR} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=CHAR} </if>
      
          <if test="soleDistCode != null or soleDistName != null or soleDistEmail != null or soleDistAddress != null or soleDistTel != null or soleDistPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="soleDistCode != null"> OR soleDistCode  LIKE CONCAT('%',#{soleDistCode},'%') </if>
      <if test="soleDistName != null">OR soleDistName  LIKE CONCAT('%',#{soleDistName},'%') </if>
      <if test="soleDistEmail != null"> OR soleDistEmail  LIKE CONCAT('%',#{soleDistEmail},'%') </if>
      <if test="soleDistAddress != null"> OR soleDistAddress  LIKE CONCAT('%',#{soleDistAddress},'%') </if>
      <if test="soleDistTel != null"> OR soleDistTel  LIKE CONCAT('%',#{soleDistTel},'%')</if>
      <if test="soleDistPhone != null"> OR soleDistPhone  LIKE CONCAT('%',#{soleDistPhone},'%') </if>
   <if test="soleDistCode != null or soleDistName != null or soleDistEmail != null or soleDistAddress != null or soleDistTel != null or soleDistPhone != null">
      	)
      </if>
	</sql>
	
	   <sql id ="soleDistCommandSearchWhereStatement">
       <if test="soleDistNo != null and soleDistNo !=  '0'  and soleDistNo !=  0"> AND soleDistNo = #{soleDistNo,jdbcType=INTEGER} </if>
       <if test="memberNo != null and memberNo !=  '0'  and memberNo !=  0"> AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="soleDistStatus != null and soleDistStatus !=  '0'  and soleDistStatus !=  0"> AND soleDistStatus = #{soleDistStatus,jdbcType=VARCHAR}  </if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null  and regAdminNo !=  '0'  and regAdminNo !=  0"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=CHAR} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=CHAR} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=CHAR} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=CHAR} </if>
      
       <if test="soleDistCode != null or soleDistName != null or soleDistEmail != null or soleDistAddress != null or soleDistTel != null or soleDistPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="soleDistCode != null"> OR soleDistCode  LIKE CONCAT('%',#{soleDistCode},'%') </if>
      <if test="soleDistName != null">OR soleDistName  LIKE CONCAT('%',#{soleDistName},'%') </if>
      <if test="soleDistEmail != null"> OR soleDistEmail  LIKE CONCAT('%',#{soleDistEmail},'%') </if>
      <if test="soleDistAddress != null"> OR soleDistAddress  LIKE CONCAT('%',#{soleDistAddress},'%') </if>
      <if test="soleDistTel != null"> OR soleDistTel  LIKE CONCAT('%',#{soleDistTel},'%')</if>
      <if test="soleDistPhone != null"> OR soleDistPhone  LIKE CONCAT('%',#{soleDistPhone},'%') </if>
   <if test="soleDistCode != null or soleDistName != null or soleDistEmail != null or soleDistAddress != null or soleDistTel != null or soleDistPhone != null">
      	)
      </if>
	</sql>
	
	
  <select id="findSoleDists" parameterType="com.returnp.admin.model.SoleDist"  resultMap="soleDist_ResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="soleDist_Column_List" />
    from sole_dist
    where 
    	1 = 1
		<include refid = "soleDistSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
    <select id="findSoleDistCommands" parameterType="com.returnp.admin.dto.command.SoleDistCommand"  resultMap="soleDistCommand_ResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="soleDistCommand_Column_List" />
    from member as M  
    inner join sole_dist as SD on (M.memberNo = SD.memberNo)
    inner join red_point as RP on (M.memberNo = RP.memberNo)
    inner join green_point as GP on (M.memberNo = GP.memberNo AND GP.nodeType ='7' )
    where 
    	1 = 1 
		<include refid = "soleDistCommandSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
  
  
  <!-- ===============================================================================================================    -->
  <!-- Branch -->
   <resultMap id="BranchResultMap" type="com.returnp.admin.model.Branch">
 <id column="branchNo" jdbcType="INTEGER" property="branchNo" />
   <id column="branchNo" jdbcType="INTEGER" property="branchNo" />
    <result column="soleDistNo" jdbcType="INTEGER" property="soleDistNo" />
    <result column="branchCode" jdbcType="VARCHAR" property="branchCode" />
    <result column="branchName" jdbcType="VARCHAR" property="branchName" />
    <result column="branchAddress" jdbcType="VARCHAR" property="branchAddress" />
    <result column="branchTel" jdbcType="VARCHAR" property="branchTel" />
    <result column="branchPhone" jdbcType="VARCHAR" property="branchPhone" />
    <result column="branchStatus" jdbcType="VARCHAR" property="branchStatus" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="branchEmail" jdbcType="VARCHAR" property="branchEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
     <resultMap id="BranchCommandResultMap" type="com.returnp.admin.dto.command.BranchCommand">
 <id column="branchNo" jdbcType="INTEGER" property="branchNo" />
   <id column="branchNo" jdbcType="INTEGER" property="branchNo" />
    <result column="soleDistNo" jdbcType="INTEGER" property="soleDistNo" />
    <result column="branchCode" jdbcType="VARCHAR" property="branchCode" />
    <result column="branchName" jdbcType="VARCHAR" property="branchName" />
    <result column="branchAddress" jdbcType="VARCHAR" property="branchAddress" />
    <result column="branchTel" jdbcType="VARCHAR" property="branchTel" />
    <result column="branchPhone" jdbcType="VARCHAR" property="branchPhone" />
    <result column="branchStatus" jdbcType="VARCHAR" property="branchStatus" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="recommenderNo" jdbcType="VARCHAR" property="recommenderNo" />
    <result column="recommenderName" jdbcType="VARCHAR" property="recommenderName" />
    <result column="soleDistName" jdbcType="INTEGER" property="soleDistName" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="branchEmail" jdbcType="VARCHAR" property="branchEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
     <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="greenPointAmount" jdbcType="REAL" property="greenPointAmount" />
    <result column="redPointAmount" jdbcType="REAL" property="redPointAmount" />
  </resultMap>
  
  <sql id="Branch_Column_List">
    branchNo, soleDistNo, branchCode, branchName, branchAddress, branchTel, branchPhone, 
    branchStatus, memberNo, recommenderNo, regType, regAdminNo, branchEmail, greenPointAccStatus, 
    redPointAccStatus, greenPointUseStatus, redPointUseStatus, createTime, updateTime
  </sql>
  
   <sql id="BranchCommand_Column_List">
    B.branchNo, 
    B.soleDistNo,
    B.branchCode, 
    B.branchName, 
    B.branchAddress, 
    B.branchTel, 
    B.branchPhone, 
    B.branchStatus, 
    B.memberNo, 
    B.recommenderNo, 
    B.regType, 
    B.regAdminNo, 
    B.branchEmail,
    B.greenPointAccStatus, 
    B.redPointAccStatus, 
    B.greenPointUseStatus, 
    B.redPointUseStatus, 
    B.createTime, 
    B.updateTime,
    M.memberEmail as memberEmail, 
    M.memberName as memberName, 
    GP.pointAmount as greenPointAmount, 
    RP.pointAmount as redPointAmount,
     M2.memberName as recommenderName,
     SD.soleDistName
  </sql>
  
    <sql id ="branchSearchWhereStatement">
      <if test="soleDistNo != null"> AND soleDistNo = #{soleDistNo,jdbcType=INTEGER} </if>
      <if test="branchNo != null"> AND branchNo = #{branchNo,jdbcType=INTEGER} </if>
      <if test="branchStatus != null and branchStatus !=  '0'  and branchStatus !=  0">AND branchStatus = #{branchStatus,jdbcType=VARCHAR}</if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="recommenderNo != null"> AND recommenderNo = #{recommenderNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      
       <if test="branchCode != null or branchName != null or branchEmail != null or branchAddress != null or branchTel != null or branchPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="branchCode != null"> OR branchCode  LIKE CONCAT('%',#{branchCode},'%') </if>
      <if test="branchName != null">OR branchName  LIKE CONCAT('%',#{branchName},'%') </if>
      <if test="branchEmail != null"> OR branchEmail  LIKE CONCAT('%',#{branchEmail},'%') </if>
      <if test="branchAddress != null"> OR branchAddress  LIKE CONCAT('%',#{branchAddress},'%') </if>
      <if test="branchTel != null"> OR branchTel  LIKE CONCAT('%',#{branchTel},'%')</if>
      <if test="branchPhone != null"> OR branchPhone  LIKE CONCAT('%',#{branchPhone},'%') </if>
     <if test="branchCode != null or branchName != null or branchEmail != null or branchAddress != null or branchTel != null or branchPhone != null">
      	)
      </if>
	</sql>
	
	 <sql id ="branchCommandSearchWhereStatement">
      <if test="soleDistNo != null"> AND B.soleDistNo = #{soleDistNo,jdbcType=INTEGER} </if>
      <if test="branchNo != null"> AND B.branchNo = #{branchNo,jdbcType=INTEGER} </if>
      <if test="branchStatus != null and branchStatus !=  '0'  and branchStatus !=  0">AND B.branchStatus = #{branchStatus,jdbcType=VARCHAR}</if>
      <if test="memberNo != null"> AND B.memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="recommenderNo != null"> AND B.recommenderNo = #{recommenderNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND B.greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND B.redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND B.greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND B.redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="regType != null"> AND B.regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null"> AND B.regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      
       <if test="branchCode != null or branchName != null or branchEmail != null or branchAddress != null or branchTel != null or branchPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="branchCode != null"> OR B.branchCode  LIKE CONCAT('%',#{branchCode},'%') </if>
      <if test="branchName != null">OR B.branchName  LIKE CONCAT('%',#{branchName},'%') </if>
      <if test="branchEmail != null"> OR B.branchEmail  LIKE CONCAT('%',#{branchEmail},'%') </if>
      <if test="branchAddress != null"> OR B.branchAddress  LIKE CONCAT('%',#{branchAddress},'%') </if>
      <if test="branchTel != null"> OR B.branchTel  LIKE CONCAT('%',#{branchTel},'%')</if>
      <if test="branchPhone != null"> OR B.branchPhone  LIKE CONCAT('%',#{branchPhone},'%') </if>
     <if test="branchCode != null or branchName != null or branchEmail != null or branchAddress != null or branchTel != null or branchPhone != null">
      	)
      </if>
	</sql>
	
	
  <select id="findBranches" parameterType="com.returnp.admin.model.Branch"  resultMap="BranchResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="Branch_Column_List" />
    from branch
    where 
    	1 = 1
		<include refid = "branchSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>

  <select id="findBranchCommands" parameterType="com.returnp.admin.dto.command.BranchCommand"  resultMap="BranchCommandResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="BranchCommand_Column_List" />
 	from branch as B  
    inner join member as M on (B.memberNo = M.memberNo)
    inner join red_point as RP on (B.memberNo = RP.memberNo)
    inner join green_point as GP on (B.memberNo = GP.memberNo AND GP.nodeType ='3' )
    left outer join member as M2 on (B.recommenderNo = M2.memberNo)
    left outer join sole_dist as SD on (B.soleDistNo= SD.soleDistNo)
    where 
    	1 = 1
		<include refid = "branchCommandSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
  
  <!-- ===============================================================================================================    -->
    <!-- SaleManager -->
  <resultMap id="SaleManagerResultMap" type="com.returnp.admin.model.SaleManager">
<id column="saleManagerNo" jdbcType="INTEGER" property="saleManagerNo" />
   <id column="saleManagerNo" jdbcType="INTEGER" property="saleManagerNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="saleManagerCode" jdbcType="VARCHAR" property="saleManagerCode" />
    <result column="saleManagerName" jdbcType="VARCHAR" property="saleManagerName" />
    <result column="saleManagerAddress" jdbcType="VARCHAR" property="saleManagerAddress" />
    <result column="saleManagerTel" jdbcType="VARCHAR" property="saleManagerTel" />
    <result column="saleManagerPhone" jdbcType="VARCHAR" property="saleManagerPhone" />
    <result column="saleManagerStatus" jdbcType="VARCHAR" property="saleManagerStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="saleManagerEmail" jdbcType="VARCHAR" property="saleManagerEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
    <resultMap id="SaleManagerCommandResultMap" type="com.returnp.admin.dto.command.SaleManagerCommand">
<id column="saleManagerNo" jdbcType="INTEGER" property="saleManagerNo" />
   <id column="saleManagerNo" jdbcType="INTEGER" property="saleManagerNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="saleManagerCode" jdbcType="VARCHAR" property="saleManagerCode" />
    <result column="saleManagerName" jdbcType="VARCHAR" property="saleManagerName" />
    <result column="saleManagerAddress" jdbcType="VARCHAR" property="saleManagerAddress" />
    <result column="saleManagerTel" jdbcType="VARCHAR" property="saleManagerTel" />
    <result column="saleManagerPhone" jdbcType="VARCHAR" property="saleManagerPhone" />
    <result column="saleManagerStatus" jdbcType="VARCHAR" property="saleManagerStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="saleManagerEmail" jdbcType="VARCHAR" property="saleManagerEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
      <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="greenPointAmount" jdbcType="REAL" property="greenPointAmount" />
    <result column="redPointAmount" jdbcType="REAL" property="redPointAmount" />
  </resultMap>
  
  <sql id="SaleManager_Column_List">
saleManagerNo, memberNo, saleManagerCode, saleManagerName, saleManagerAddress, saleManagerTel, 
    saleManagerPhone, saleManagerStatus, regType, regAdminNo, saleManagerEmail, greenPointAccStatus, 
    redPointAccStatus, greenPointUseStatus, redPointUseStatus, createTime, updateTime
  </sql>
  
<sql id="SaleManagerCommand_Column_List">
	SB.saleManagerNo, 
	SB.memberNo, 
	SB.saleManagerCode, 
	SB.saleManagerName, 
	SB.saleManagerAddress, 
	SB.saleManagerTel, 
    SB.saleManagerPhone,
    SB.saleManagerStatus, 
    SB.regType,
    SB.regAdminNo,
	SB.saleManagerEmail, 
	SB.greenPointAccStatus, 
    SB.redPointAccStatus, 
    SB.greenPointUseStatus, 
    SB.redPointUseStatus, 
    SB.createTime, 
    SB.updateTime,
    M.memberEmail as memberEmail, 
    M.memberName as memberName, 
    GP.pointAmount as greenPointAmount, 
    RP.pointAmount as redPointAmount
  </sql>
 
   <sql id ="saleManagerSearchWhereStatement">
      <if test="saleManagerNo != null"> AND saleManagerNo = #{saleManager,jdbcType=INTEGER}</if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="saleManagerStatus != null and saleManagerStatus !=  '0'  and saleManagerStatus !=  0"> AND saleManagerStatus = #{saleManagerStatus,jdbcType=VARCHAR}</if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR}</if>
       <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="saleManagerCode != null or saleManagerName != null or saleManagerAddress != null or saleManagerTel != null or saleManagerPhone != null or saleManagerEmail != null">
      	AND ( 1 = 2 
      </if>
       <if test="saleManagerCode != null"> OR saleManagerCode  LIKE CONCAT('%',#{saleManagerCode},'%')</if>
      <if test="saleManagerName != null"> OR saleManagerName  LIKE CONCAT('%',#{saleManagerName},'%')</if>
      <if test="saleManagerEmail != null"> OR saleManagerEmail  LIKE CONCAT('%',#{saleManagerEmail},'%')</if>
      <if test="saleManagerAddress != null"> OR saleManagerAddress  LIKE CONCAT('%',#{saleManagerAddress},'%')</if>
      <if test="saleManagerTel != null"> OR saleManagerTel  LIKE CONCAT('%',#{saleManagerTel},'%')</if>
      <if test="saleManagerPhone != null"> OR saleManagerPhone  LIKE CONCAT('%',#{saleManagerPhone},'%')</if>
      <if test="saleManagerCode != null or saleManagerName != null or saleManagerAddress != null or saleManagerTel != null or saleManagerPhone != null or saleManagerEmail != null">
      	)
      </if>
	</sql>

   <sql id ="saleManagerCommandSearchWhereStatement">
      <if test="saleManagerNo != null"> AND saleManagerNo = #{saleManager,jdbcType=INTEGER}</if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="saleManagerStatus != null and saleManagerStatus !=  '0'  and saleManagerStatus !=  0"> AND saleManagerStatus = #{saleManagerStatus,jdbcType=VARCHAR}</if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR}</if>
       <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="saleManagerCode != null or saleManagerName != null or saleManagerAddress != null or saleManagerTel != null or saleManagerPhone != null or saleManagerEmail != null">
      	AND ( 1 = 2 
      </if>
       <if test="saleManagerCode != null"> OR saleManagerCode  LIKE CONCAT('%',#{saleManagerCode},'%')</if>
      <if test="saleManagerName != null"> OR saleManagerName  LIKE CONCAT('%',#{saleManagerName},'%')</if>
      <if test="saleManagerEmail != null"> OR saleManagerEmail  LIKE CONCAT('%',#{saleManagerEmail},'%')</if>
      <if test="saleManagerAddress != null"> OR saleManagerAddress  LIKE CONCAT('%',#{saleManagerAddress},'%')</if>
      <if test="saleManagerTel != null"> OR saleManagerTel  LIKE CONCAT('%',#{saleManagerTel},'%')</if>
      <if test="saleManagerPhone != null"> OR saleManagerPhone  LIKE CONCAT('%',#{saleManagerPhone},'%')</if>
      <if test="saleManagerCode != null or saleManagerName != null or saleManagerAddress != null or saleManagerTel != null or saleManagerPhone != null or saleManagerEmail != null">
      	)
      </if>
	</sql>
	
  <select id="findSaleManagers" parameterType="com.returnp.admin.model.SaleManager"  resultMap="SaleManagerResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="SaleManager_Column_List" />
    from sale_manager
    where 
    	1 = 1
		<include refid = "saleManagerSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
 
   <select id="findSaleManagerCommands" parameterType="com.returnp.admin.dto.command.SaleManagerCommand"  resultMap="SaleManagerCommandResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="SaleManagerCommand_Column_List" />
  from member as M  
    inner join sale_manager as SB on (M.memberNo = SB.memberNo)
    inner join red_point as RP on (M.memberNo = RP.memberNo)
    inner join green_point as GP on (M.memberNo = GP.memberNo AND GP.nodeType ='6' )
    where 
      1 = 1
		<include refid = "saleManagerSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select> 
  
 <!-- ===============================================================================================================    --> 
  <!-- Agency -->
  <resultMap id="AgencyResultMap" type="com.returnp.admin.model.Agency">
    <id column="agencyNo" jdbcType="INTEGER" property="agencyNo" />
    <result column="agencyCode" jdbcType="VARCHAR" property="agencyCode" />
    <result column="agencyName" jdbcType="VARCHAR" property="agencyName" />
    <result column="agencyAddress" jdbcType="VARCHAR" property="agencyAddress" />
    <result column="agencyTel" jdbcType="VARCHAR" property="agencyTel" />
    <result column="agencyPhone" jdbcType="VARCHAR" property="agencyPhone" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="branchNo" jdbcType="INTEGER" property="branchNo" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="agencyStatus" jdbcType="VARCHAR" property="agencyStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="agencyEmail" jdbcType="VARCHAR" property="agencyEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
    <resultMap id="AgencyCommandResultMap" type="com.returnp.admin.dto.command.AgencyCommand">
    <id column="agencyNo" jdbcType="INTEGER" property="agencyNo" />
    <result column="agencyCode" jdbcType="VARCHAR" property="agencyCode" />
    <result column="agencyName" jdbcType="VARCHAR" property="agencyName" />
    <result column="agencyAddress" jdbcType="VARCHAR" property="agencyAddress" />
    <result column="agencyTel" jdbcType="VARCHAR" property="agencyTel" />
    <result column="agencyPhone" jdbcType="VARCHAR" property="agencyPhone" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="branchNo" jdbcType="INTEGER" property="branchNo" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="recommenderName" jdbcType="VARCHAR" property="recommenderName" />
    <result column="agencyStatus" jdbcType="VARCHAR" property="agencyStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="agencyEmail" jdbcType="VARCHAR" property="agencyEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="greenPointAmount" jdbcType="REAL" property="greenPointAmount" />
    <result column="redPointAmount" jdbcType="REAL" property="redPointAmount" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="branchName" jdbcType="VARCHAR" property="branchName" />
  </resultMap>
  
  
  <sql id="Agency_Column_List">
    agencyNo, agencyCode, agencyName, agencyAddress, agencyTel, agencyPhone, memberNo, 
    branchNo, recommenderNo, agencyStatus, regType, regAdminNo, agencyEmail, greenPointAccStatus, 
    redPointAccStatus, greenPointUseStatus, redPointUseStatus, createTime, updateTime
  </sql>
  
   <sql id="AgencyCommand_Column_List">
    A.agencyNo, 
    A.agencyCode, 
    A.agencyName, 
    A.agencyAddress,
    A.agencyTel,
    A.agencyPhone, 
    A.memberNo, 
    A.branchNo, 
    A.recommenderNo, 
    A.agencyStatus, 
    A.regType, 
    A.regAdminNo, 
    A.agencyEmail, 
    A.greenPointAccStatus, 
    A.redPointAccStatus,
    A.greenPointUseStatus,
    A.redPointUseStatus, 
    A.createTime, 
    A.updateTime,
   	M.memberEmail as memberEmail, 
    M.memberName as memberName, 
    GP.pointAmount as greenPointAmount, 
    RP.pointAmount as redPointAmount,
    M2.memberName as recommenderName,
    BR.branchName
  </sql>
  
  
   <sql id ="agencySearchWhereStatement">
      <if test="agencyNo != null">AND agencyNo = #{agency,jdbcType=INTEGER}</if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="branchNo != null"> AND branchNo = #{branchNo,jdbcType=INTEGER}</if>
      <if test="recommenderNo != null"> AND recommenderNo = #{recommenderNo,jdbcType=INTEGER}</if>
      <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="agencyStatus != null and agencyStatus != '0'  and agencyStatus != 0 "> AND agencyStatus = #{agencyStatus,jdbcType=VARCHAR}</if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR}</if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
       <if test="agencyEmail != null or agencyCode != null or agencyName != null or agencyAddress != null or agencyTel != null or agencyPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="agencyEmail != null"> OR agencyEmail  LIKE CONCAT('%',#{agencyEmail},'%') </if>
       <if test="agencyCode != null"> OR agencyCode  LIKE CONCAT('%',#{agencyCode},'%') </if>
      <if test="agencyName != null"> OR agencyName  LIKE CONCAT('%',#{agencyName},'%') </if>
      <if test="agencyAddress != null"> OR agencyAddress  LIKE CONCAT('%',#{agencyAddress},'%') </if>
      <if test="agencyTel != null"> OR agencyTel  LIKE CONCAT('%',#{agencyTel},'%') </if>
      <if test="agencyPhone != null"> OR agencyPhone  LIKE CONCAT('%',#{agencyPhone},'%') </if>
    <if test="agencyEmail != null or agencyCode != null or agencyName != null or agencyAddress != null or agencyTel != null or agencyPhone != null">
      	)
      </if>
	</sql>
	
	   <sql id ="agencyCommandSearchWhereStatement">
      <if test="agencyNo != null">AND A.agencyNo = #{agencyNo,jdbcType=INTEGER}</if>
      <if test="memberNo != null"> AND A.memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="branchNo != null"> AND A.branchNo = #{branchNo,jdbcType=INTEGER}</if>
      <if test="recommenderNo != null"> AND A.recommenderNo = #{recommenderNo,jdbcType=INTEGER}</if>
      <if test="greenPointAccStatus != null"> AND A.greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND A.redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND A.greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND A.redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="regAdminNo != null"> AND A.regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="agencyStatus != null and agencyStatus != '0'  and agencyStatus != 0 "> AND A.agencyStatus = #{agencyStatus,jdbcType=VARCHAR}</if>
      <if test="regType != null"> AND A.regType = #{regType,jdbcType=CHAR}</if>
      <if test="regAdminNo != null"> AND A.regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
       <if test="agencyEmail != null or agencyCode != null or agencyName != null or agencyAddress != null or agencyTel != null or agencyPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="agencyEmail != null"> OR A.agencyEmail  LIKE CONCAT('%',#{agencyEmail},'%') </if>
       <if test="agencyCode != null"> OR A.agencyCode  LIKE CONCAT('%',#{agencyCode},'%') </if>
      <if test="agencyName != null"> OR A.agencyName  LIKE CONCAT('%',#{agencyName},'%') </if>
      <if test="agencyAddress != null"> OR A.agencyAddress  LIKE CONCAT('%',#{agencyAddress},'%') </if>
      <if test="agencyTel != null"> OR A.agencyTel  LIKE CONCAT('%',#{agencyTel},'%') </if>
      <if test="agencyPhone != null"> OR A.agencyPhone  LIKE CONCAT('%',#{agencyPhone},'%') </if>
    <if test="agencyEmail != null or agencyCode != null or agencyName != null or agencyAddress != null or agencyTel != null or agencyPhone != null">
      	)
      </if>
	</sql>
	
	
	<select id="findAgencies" parameterType="com.returnp.admin.model.Agency"  resultMap="AgencyResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="Agency_Column_List" />
    from agency
    where 
    	1 = 1
		<include refid = "agencySearchWhereStatement"/>
		<include refid = "commonStatement"/>
  	</select>
  	
  	<select id="findAgencyCommands" parameterType="com.returnp.admin.dto.command.AgencyCommand"  resultMap="AgencyCommandResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="AgencyCommand_Column_List" />
 	from agency as A  
    inner join member as M on (A.memberNo = M.memberNo)
    inner join red_point as RP on (A.memberNo = RP.memberNo)
    inner join green_point as GP on (A.memberNo = GP.memberNo AND GP.nodeType ='4' )
    left outer join member as M2 on (A.recommenderNo = M2.memberNo)
    left outer join branch as BR on (A.branchNo= BR.branchNo)
    where 
    	1 = 1 
		<include refid = "agencyCommandSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  	</select>
  	
  <!-- ===============================================================================================================    -->
  <!-- Affiliate -->
  <resultMap id="AffiliateResultMap" type="com.returnp.admin.model.Affiliate">
    <id column="affiliateNo" jdbcType="INTEGER" property="affiliateNo" />
    <result column="affiliateSerial" jdbcType="VARCHAR" property="affiliateSerial" />
    <result column="affiliateCode" jdbcType="VARCHAR" property="affiliateCode" />
    <result column="affiliateName" jdbcType="VARCHAR" property="affiliateName" />
    <result column="affiliateAddress" jdbcType="VARCHAR" property="affiliateAddress" />
    <result column="affiliateTel" jdbcType="VARCHAR" property="affiliateTel" />
    <result column="affiliatePhone" jdbcType="VARCHAR" property="affiliatePhone" />
    <result column="affiliateType" jdbcType="VARCHAR" property="affiliateType" />
    <result column="affiliateComm" jdbcType="FLOAT" property="affiliateComm" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="agencyNo" jdbcType="INTEGER" property="agencyNo" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="affiliateStatus" jdbcType="VARCHAR" property="affiliateStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="affiliateEmail" jdbcType="VARCHAR" property="affiliateEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
    <resultMap id="AffiliateCommandResultMap" type="com.returnp.admin.dto.command.AffiliateCommand">
    <id column="affiliateNo" jdbcType="INTEGER" property="affiliateNo" />
    <result column="affiliateSerial" jdbcType="VARCHAR" property="affiliateSerial" />
    <result column="affiliateCode" jdbcType="VARCHAR" property="affiliateCode" />
    <result column="affiliateName" jdbcType="VARCHAR" property="affiliateName" />
    <result column="affiliateAddress" jdbcType="VARCHAR" property="affiliateAddress" />
    <result column="affiliateTel" jdbcType="VARCHAR" property="affiliateTel" />
    <result column="affiliatePhone" jdbcType="VARCHAR" property="affiliatePhone" />
    <result column="affiliateType" jdbcType="VARCHAR" property="affiliateType" />
     <result column="affiliateComm" jdbcType="FLOAT" property="affiliateComm" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="agencyNo" jdbcType="INTEGER" property="agencyNo" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="affiliateStatus" jdbcType="VARCHAR" property="affiliateStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="affiliateEmail" jdbcType="VARCHAR" property="affiliateEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="greenPointAmount" jdbcType="REAL" property="greenPointAmount" />
    <result column="redPointAmount" jdbcType="REAL" property="redPointAmount" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="nodeNo" jdbcType="INTEGER" property="nodeNo" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
    <result column="roadFullAddr" jdbcType="VARCHAR" property="roadFullAddr" />
    <result column="roadAddrPart1" jdbcType="VARCHAR" property="roadAddrPart1" />
    <result column="roadAddrPart2" jdbcType="VARCHAR" property="roadAddrPart2" />
    <result column="addrDetail" jdbcType="VARCHAR" property="addrDetail" />
    <result column="engAddr" jdbcType="VARCHAR" property="engAddr" />
    <result column="jibunAddr" jdbcType="VARCHAR" property="jibunAddr" />
    <result column="zipNo" jdbcType="VARCHAR" property="zipNo" />
    <result column="admCd" jdbcType="VARCHAR" property="admCd" />
    <result column="rnMgtSn" jdbcType="VARCHAR" property="rnMgtSn" />
    <result column="bdMgtSn" jdbcType="VARCHAR" property="bdMgtSn" />
    <result column="lat" jdbcType="VARCHAR" property="lat" />
    <result column="lng" jdbcType="VARCHAR" property="lng" />
    <result column="recommenderName" jdbcType="VARCHAR" property="recommenderName" />
    <result column="agencyName" jdbcType="VARCHAR" property="agencyName" />
  </resultMap>
  
  <sql id="Affiliate_Column_List">
    affiliateNo, affiliateSerial, affiliateCode, affiliateName, affiliateAddress, affiliateTel, 
    affiliatePhone, affiliateType, affiliateComm, memberNo, agencyNo, recommenderNo, affiliateStatus, regType, regAdminNo, 
    affiliateEmail, greenPointAccStatus, redPointAccStatus, greenPointUseStatus, redPointUseStatus, 
    createTime, updateTime
  </sql>
  
    <sql id="AffiliateCommand_Column_List">
    AF.affiliateNo, 
    AF.affiliateSerial, 
    AF.affiliateCode, 
    AF.affiliateName, 
    AF.affiliateAddress, 
    AF.affiliateTel, 
    AF.affiliatePhone, 
    AF.affiliateType,
    AF.affiliateComm,
    AF.memberNo, 
    AF.agencyNo, 
    AF.recommenderNo, 
    AF.affiliateStatus,
    AF.regType, 
    AF.regAdminNo, 
    AF.affiliateEmail, 
    AF.greenPointAccStatus, 
    AF.redPointAccStatus, 
    AF.greenPointUseStatus, 
    AF.redPointUseStatus, 
    AF.createTime, 
    AF.updateTime,
  	M.memberEmail as memberEmail, 
    M.memberName as memberName, 
    GP.pointAmount as greenPointAmount, 
    RP.pointAmount as redPointAmount,
    MA.memberAddressNo, 
    MA.memberNo, 
    MA.nodeNo, 
    MA.nodeType, 
    MA.roadFullAddr, 
    MA.roadAddrPart1, 
    MA.roadAddrPart2, 
    MA.addrDetail, 
    MA.engAddr, 
    MA.jibunAddr, 
    MA.zipNo, 
    MA.admCd, 
    MA.rnMgtSn, 
    MA.bdMgtSn, 
    MA.lat, 
    MA.lng,
    M2.memberName as recommenderName,
    AG.agencyName
  </sql>
  
    <sql id ="affiliateSearchWhereStatement">
      <if test="affiliateNo != null">AND affiliateNo = #{affiliateNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null">AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="agencyNo != null">AND agencyNo = #{agencyNo,jdbcType=INTEGER} </if>
      <if test="affiliateSerial != null">AND affiliateSerial = #{affiliateSerial,jdbcType=VARCHAR} </if>
      <if test="affiliateType != null">AND affiliateType = #{affiliateType,jdbcType=VARCHAR} </if>
      <if test="recommenderNo != null">AND recommenderNo = #{recommenderNo,jdbcType=INTEGER} </if>
       <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="affiliateStatus != null and affiliateStatus !=  '0'  and affiliateStatus !=  0">AND affiliateStatus = #{affiliateStatus,jdbcType=VARCHAR} </if>
      <if test="regType != null">AND regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null">AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      
       <if test="affiliateCode != null or affiliateAddress != null or affiliateTel != null or affiliatePhone != null or affiliateName != null  or affiliateEmail != null">
      	AND ( 1 = 2 
      </if>
       <if test="affiliateCode != null"> OR affiliateCode  LIKE CONCAT('%',#{affiliateCode},'%')</if>
      <if test="affiliateAddress != null"> OR affiliateAddress  LIKE CONCAT('%',#{affiliateAddress},'%')</if>
      <if test="affiliateEmail != null"> OR affiliateEmail  LIKE CONCAT('%',#{affiliateEmail},'%')</if>
      <if test="affiliateTel != null"> OR affiliateTel  LIKE CONCAT('%',#{affiliateTel},'%')</if>
      <if test="affiliatePhone != null">OR affiliatePhone  LIKE CONCAT('%',#{affiliatePhone},'%') </if>
      <if test="affiliateName != null">OR affiliateName  LIKE CONCAT('%',#{affiliateName},'%')</if>
       <if test="affiliateCode != null or affiliateAddress != null or affiliateTel != null or affiliatePhone != null or affiliateName != null  or affiliateEmail != null">
      	)
      </if>
   </sql>
   
       <sql id ="affiliateCommandSearchWhereStatement">
      <if test="affiliateNo != null">AND affiliateNo = #{affiliateNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null">AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="agencyNo != null">AND agencyNo = #{agencyNo,jdbcType=INTEGER} </if>
      <if test="affiliateSerial != null">AND affiliateSerial = #{affiliateSerial,jdbcType=VARCHAR} </if>
      <if test="affiliateType != null">AND affiliateType = #{affiliateType,jdbcType=VARCHAR} </if>
      <if test="recommenderNo != null">AND recommenderNo = #{recommenderNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>
      <if test="affiliateStatus != null and affiliateStatus !=  '0'  and affiliateStatus !=  0">AND affiliateStatus = #{affiliateStatus,jdbcType=VARCHAR} </if>
      <if test="regType != null">AND regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null">AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      
       <if test="affiliateCode != null or affiliateAddress != null or affiliateTel != null or affiliatePhone != null or affiliateName != null  or affiliateEmail != null ">
      	AND ( 1 = 2 
      </if>
       <if test="affiliateCode != null"> OR affiliateCode  LIKE CONCAT('%',#{affiliateCode},'%')</if>
      <if test="affiliateAddress != null"> OR affiliateAddress  LIKE CONCAT('%',#{affiliateAddress},'%')</if>
      <if test="affiliateEmail != null"> OR affiliateEmail  LIKE CONCAT('%',#{affiliateEmail},'%')</if>
      <if test="affiliateTel != null"> OR affiliateTel  LIKE CONCAT('%',#{affiliateTel},'%')</if>
      <if test="affiliatePhone != null">OR affiliatePhone  LIKE CONCAT('%',#{affiliatePhone},'%') </if>
      <if test="affiliateName != null">OR affiliateName  LIKE CONCAT('%',#{affiliateName},'%')</if>
       <if test="affiliateCode != null or affiliateAddress != null or affiliateTel != null or affiliatePhone != null or affiliateName != null  or affiliateEmail != null ">
      	)
      </if>
   </sql>
  
    <select id="findAffiliates" parameterType="com.returnp.admin.model.Affiliate"  resultMap="AffiliateResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="Affiliate_Column_List" />
    from affiliate
    where 
    	1 = 1
		<include refid = "affiliateSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
<!--   <select id="findAffiliateCommands" parameterType="com.returnp.admin.dto.command.AffiliateCommand"  resultMap="AffiliateCommandResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="AffiliateCommand_Column_List" />
	 from member as M  
    inner join affiliate as AF on (M.memberNo = AF.memberNo)
    inner join red_point as RP on (M.memberNo = RP.memberNo)
    inner join green_point as GP on (M.memberNo = GP.memberNo AND GP.nodeType ='5' )    
    left outer join member_address as MA on (AF.affiliateNo = MA.nodeNo AND MA.nodeType ='5' )
    left outer join member as M2 on (AF.recommenderNo = M2.memberNo)
    where 
      1 = 1
		<include refid = "affiliateSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select> -->
  
  <select id="findAffiliateCommands" parameterType="com.returnp.admin.dto.command.AffiliateCommand"  resultMap="AffiliateCommandResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="AffiliateCommand_Column_List" />
	 from affiliate as AF  
    inner join member as M on (AF.memberNo = M.memberNo)
    inner join red_point as RP on (AF.memberNo = RP.memberNo)
    inner join green_point as GP on (AF.memberNo = GP.memberNo AND GP.nodeType ='5' )    
    left outer join member_address as MA on (AF.affiliateNo = MA.nodeNo AND MA.nodeType ='5' )
    left outer join member as M2 on (AF.recommenderNo = M2.memberNo)
    left outer join agency as AG on (AF.agencyNo= AG.agencyNo)
    where 
      1 = 1
		<include refid = "affiliateSearchWhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
  
  <!-- ===============================================================================================================    -->
  <!-- Recommender -->
  <resultMap id="RecommenderCommandResultMap" type="com.returnp.admin.dto.command.RecommenderCommand">
    <id column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="recommenderCode" jdbcType="VARCHAR" property="recommenderCode" />
    <result column="recommenderName" jdbcType="VARCHAR" property="recommenderName" />
    <result column="recommenderAddress" jdbcType="VARCHAR" property="recommenderAddress" />
    <result column="recommenderTel" jdbcType="VARCHAR" property="recommenderTel" />
    <result column="recommenderPhone" jdbcType="VARCHAR" property="recommenderPhone" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="saleManagerNo" jdbcType="INTEGER" property="saleManagerNo" />
    <result column="recommenderStatus" jdbcType="VARCHAR" property="recommenderStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="recommenderEmail" jdbcType="VARCHAR" property="recommenderEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" /> 
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="membershipRequestNo" jdbcType="INTEGER" property="membershipRequestNo" />
    <result column="companyBankAccountNo" jdbcType="INTEGER" property="companyBankAccountNo" />
    <result column="paymentStatus" jdbcType="VARCHAR" property="paymentStatus" />
    <result column="paymentType" jdbcType="VARCHAR" property="paymentType" />
  </resultMap>
  
    <resultMap id="RecommenderCommand2ResultMap" type="com.returnp.admin.dto.command.RecommenderCommand2">
    <id column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="recommenderCode" jdbcType="VARCHAR" property="recommenderCode" />
    <result column="recommenderName" jdbcType="VARCHAR" property="recommenderName" />
    <result column="recommenderAddress" jdbcType="VARCHAR" property="recommenderAddress" />
    <result column="recommenderTel" jdbcType="VARCHAR" property="recommenderTel" />
    <result column="recommenderPhone" jdbcType="VARCHAR" property="recommenderPhone" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="saleManagerNo" jdbcType="INTEGER" property="saleManagerNo" />
    <result column="recommenderStatus" jdbcType="VARCHAR" property="recommenderStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="recommenderEmail" jdbcType="VARCHAR" property="recommenderEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
     <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="greenPointAmount" jdbcType="REAL" property="greenPointAmount" />
    <result column="redPointAmount" jdbcType="REAL" property="redPointAmount" />
    
  </resultMap>
  
  
   <resultMap id="RecommenderResultMap" type="com.returnp.admin.model.Recommender">
    <id column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="recommenderCode" jdbcType="VARCHAR" property="recommenderCode" />
    <result column="recommenderName" jdbcType="VARCHAR" property="recommenderName" />
    <result column="recommenderAddress" jdbcType="VARCHAR" property="recommenderAddress" />
    <result column="recommenderTel" jdbcType="VARCHAR" property="recommenderTel" />
    <result column="recommenderPhone" jdbcType="VARCHAR" property="recommenderPhone" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="saleManagerNo" jdbcType="INTEGER" property="saleManagerNo" />
    <result column="recommenderStatus" jdbcType="VARCHAR" property="recommenderStatus" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="recommenderEmail" jdbcType="VARCHAR" property="recommenderEmail" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
  <sql id="Recommender_Column_List">
    recommenderNo, recommenderCode, recommenderName, recommenderAddress, recommenderTel, 
    recommenderPhone, memberNo, saleManagerNo, recommenderStatus, regType, regAdminNo, 
    recommenderEmail, greenPointAccStatus, redPointAccStatus, greenPointUseStatus, redPointUseStatus, 
    createTime, updateTime
  </sql>
  
  <sql id="RecommenderCommand_Column_List">
 	R.recommenderNo as recommenderNo, 
 	R.recommenderCode as recommenderCode, 
 	R.recommenderName as recommenderName, 
 	R.recommenderAddress as recommenderAddress,
 	R.recommenderTel as recommenderTel, 
    R.recommenderPhone as recommenderPhone,
    R.memberNo as memberNo, 
    R.saleManagerNo as saleManagerNo, 
    R.recommenderStatus as recommenderStatus,
    R.regType as regType,
    R.regAdminNo as regAdminNo , 
    R.recommenderEmail as recommenderEmail,
    R.greenPointAccStatus as greenPointAccStatus, 
    R.redPointAccStatus as redPointAccStatus, 
    R.greenPointUseStatus as greenPointUseStatus, 
    R.redPointUseStatus as redPointUseStatus, 
	MQ.membershipRequestNo as membershipRequestNo,
    MQ.paymentStatus as paymentStatus, 
    MQ.paymentAmount as paymentAmount, 
    MQ.paymentType as paymentType,
    MQ.companyBankAccountNo as companyBankAccountNo, 
    R.createTime as createTime, 
    R.updateTime as updateTime
  </sql>
  
    <sql id="RecommenderCommand2_Column_List">
    R.recommenderNo, 
    R.recommenderCode, 
    R.recommenderName, 
    R.recommenderAddress, 
    R.recommenderTel, 
    R.recommenderPhone, 
    R.memberNo, 
    R.saleManagerNo,
    R.recommenderStatus, 
    R.regType,
    R.regAdminNo, 
    R.recommenderEmail, 
    R.greenPointAccStatus, 
    R.redPointAccStatus, 
    R.greenPointUseStatus, 
    R.redPointUseStatus, 
    R.createTime, 
    R.updateTime,
    M.memberEmail as memberEmail, 
    M.memberName as memberName, 
    GP.pointAmount as greenPointAmount, 
    RP.pointAmount as redPointAmount
  </sql>
  
  	
  	<sql id ="recommender_WhereStatement">
      <if test="recommenderNo != null"> AND recommenderNo = #{recommenderNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="saleManagerNo != null"> AND saleManagerNo = #{saleManagerNo,jdbcType=INTEGER} </if>
      <if test="recommenderStatus != null and recommenderStatus !=  '0'  and recommenderStatus !=  0"> AND recommenderStatus = #{recommenderStatus,jdbcType=VARCHAR} </if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>

 	 <if test="recommenderCode != null or recommenderName != null or recommenderAddress != null or recommenderPhone != null or recommenderEmail != null or recommenderPhone != null">
      	AND ( 1 = 2 
      </if>
	
      <if test="recommenderName != null">  OR R.recommenderName  LIKE CONCAT('%',#{recommenderName},'%') </if>
      <if test="recommenderAddress != null"> OR R.recommenderAddress  LIKE CONCAT('%',#{recommenderAddress},'%') </if>
      
      <if test="recommenderTel != null">  OR R.recommenderTel  LIKE CONCAT('%',#{recommenderTel},'%') </if>
      <if test="recommenderPhone != null">  OR R.recommenderPhone  LIKE CONCAT('%',#{recommenderPhone},'%') </if>
      <if test="recommenderEmail != null">  OR R.recommenderEmail  LIKE CONCAT('%',#{recommenderEmail},'%')  </if>
      <if test="recommenderCode != null or recommenderName != null or recommenderAddress != null or recommenderPhone != null or recommenderEmail != null or recommenderPhone != null">
      	)
      </if>
	</sql>
	
    <sql id ="recommenderCommand_WhereStatement">
      <if test="recommenderNo != null"> AND R.recommenderNo = #{recommenderNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null"> AND R.memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="saleManagerNo != null"> AND R.saleManagerNo = #{saleManagerNo,jdbcType=INTEGER} </if>
      <if test="recommenderStatus != null and recommenderStatus !=  '0'  and recommenderStatus !=  0"> AND recommenderStatus = #{recommenderStatus,jdbcType=VARCHAR} </if>
      <if test="regType != null"> AND R.regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null"> AND R.regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND R.greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND R.redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND R.greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND R.redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>

 	 <if test="recommenderCode != null or recommenderName != null or recommenderAddress != null or recommenderPhone != null or recommenderEmail != null or recommenderPhone != null">
      	AND ( 1 = 2 
      </if>
	
      <if test="recommenderName != null">  OR R.recommenderName  LIKE CONCAT('%',#{recommenderName},'%') </if>
      <if test="recommenderAddress != null"> OR R.recommenderAddress  LIKE CONCAT('%',#{recommenderAddress},'%') </if>
      
      <if test="recommenderTel != null">  OR R.recommenderTel  LIKE CONCAT('%',#{recommenderTel},'%') </if>
      <if test="recommenderPhone != null">  OR R.recommenderPhone  LIKE CONCAT('%',#{recommenderPhone},'%') </if>
      <if test="recommenderEmail != null">  OR R.recommenderEmail  LIKE CONCAT('%',#{recommenderEmail},'%')  </if>
      <if test="recommenderCode != null or recommenderName != null or recommenderAddress != null or recommenderPhone != null or recommenderEmail != null or recommenderPhone != null">
      	)
      </if>
	</sql>
	
	  	<sql id ="recommenderCommand2_WhereStatement">
      <if test="recommenderNo != null"> AND recommenderNo = #{recommenderNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="saleManagerNo != null"> AND saleManagerNo = #{saleManagerNo,jdbcType=INTEGER} </if>
      <if test="recommenderStatus != null and recommenderStatus !=  '0'  and recommenderStatus !=  0"> AND recommenderStatus = #{recommenderStatus,jdbcType=VARCHAR} </if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR} </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
      <if test="greenPointAccStatus != null"> AND greenPointAccStatus = #{greenPointAccStatus,jdbcType=INTEGER} </if>
      <if test="redPointAccStatus != null"> AND redPointAccStatus = #{redPointAccStatus,jdbcType=INTEGER} </if>
      <if test="greenPointUseStatus != null"> AND greenPointUseStatus = #{greenPointUseStatus,jdbcType=INTEGER} </if>
      <if test="redPointUseStatus != null"> AND redPointUseStatus = #{redPointUseStatus,jdbcType=INTEGER} </if>

 	 <if test="recommenderCode != null or recommenderName != null or recommenderAddress != null or recommenderPhone != null or recommenderEmail != null or recommenderPhone != null">
      	AND ( 1 = 2 
      </if>
	
      <if test="recommenderName != null">  OR R.recommenderName  LIKE CONCAT('%',#{recommenderName},'%') </if>
      <if test="recommenderAddress != null"> OR R.recommenderAddress  LIKE CONCAT('%',#{recommenderAddress},'%') </if>
      
      <if test="recommenderTel != null">  OR R.recommenderTel  LIKE CONCAT('%',#{recommenderTel},'%') </if>
      <if test="recommenderPhone != null">  OR R.recommenderPhone  LIKE CONCAT('%',#{recommenderPhone},'%') </if>
      <if test="recommenderEmail != null">  OR R.recommenderEmail  LIKE CONCAT('%',#{recommenderEmail},'%')  </if>
      <if test="recommenderCode != null or recommenderName != null or recommenderAddress != null or recommenderPhone != null or recommenderEmail != null or recommenderPhone != null">
      	)
      </if>
	</sql>
	
  <select id="findRecommenderCommands" parameterType="com.returnp.admin.model.Recommender"  resultMap="RecommenderCommandResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="RecommenderCommand_Column_List"/>
    from recommender as R
    left outer join membership_request as MQ on (R.recommenderNo = MQ.recommenderNo) 
    where 
    	1 = 1
		<include refid = "recommenderCommand_WhereStatement"/>
		<include refid = "commonStatement"/>
  </select>

  <select id="findRecommenders" parameterType="com.returnp.admin.model.Recommender"  resultMap="RecommenderResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="Recommender_Column_List" />
    from recommender
    where 
    	1 = 1
		<include refid = "recommender_WhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
    <select id="findRecommenderCommand2s" parameterType="com.returnp.admin.dto.command.RecommenderCommand2"  resultMap="RecommenderCommand2ResultMap" >
    select 
    sql_calc_found_rows 
    <include refid="RecommenderCommand2_Column_List" />
  	from member as M  
    inner join recommender as R on (M.memberNo = R.memberNo)
    inner join red_point as RP on (M.memberNo = RP.memberNo)
    inner join green_point as GP on (M.memberNo = GP.memberNo AND GP.nodeType ='2' )
    where 
      1 = 1
		<include refid = "recommenderCommand2_WhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
  <!-- ===============================================================================================================    -->
  <!-- MembershipRequest  find Mapper -->
  
    <resultMap id="default_membershipRequestResultMap" type="com.returnp.admin.model.MembershipRequest">
    <id column="membershipRequestNo" jdbcType="INTEGER" property="membershipRequestNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="companyBankAccountNo" jdbcType="INTEGER" property="companyBankAccountNo" />
    <result column="paymentAmount" jdbcType="INTEGER" property="paymentAmount" />
    <result column="depositor" jdbcType="VARCHAR" property="depositor" />
    <result column="paymentStatus" jdbcType="CHAR" property="paymentStatus" />
    <result column="gradeType" jdbcType="VARCHAR" property="gradeType" />
    <result column="paymentType" jdbcType="VARCHAR" property="paymentType" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
  </resultMap>
  
    <resultMap id="membershipRequestCommand_ResultMap" type="com.returnp.admin.dto.command.MembershipRequestCommand">
    <id column="membershipRequestNo" jdbcType="INTEGER" property="membershipRequestNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="paymentAmount" jdbcType="INTEGER" property="paymentAmount" />
    <result column="paymentStatus" jdbcType="CHAR" property="paymentStatus" />
    <result column="gradeType" jdbcType="VARCHAR" property="gradeType" />
    <result column="depositor" jdbcType="VARCHAR" property="depositor" />
    <result column="paymentType" jdbcType="VARCHAR" property="paymentType" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="companyBankAccountNo" jdbcType="INTEGER" property="companyBankAccountNo" />
    <result column="bankName" jdbcType="VARCHAR" property="bankName" />
    <result column="bankAccount" jdbcType="VARCHAR" property="bankAccount" />
    <result column="bankOwnerName" jdbcType="VARCHAR" property="bankOwnerName" />
  </resultMap>
  
  <sql id="membershipRequestCommand_Column_List">
    MQ.membershipRequestNo as membershipRequestNo, 
    MQ.memberNo as memberNo, 
    MQ.paymentAmount as paymentAmount, 
    MQ.paymentStatus as paymentStatus , 
    MQ.depositor as depositor, 
    MQ.gradeType as gradeType, 
    MQ.paymentType as paymentType, 
    MQ.regType as regType, 
    MQ.regAdminNo as regAdminNo, 
    MQ.updateTime as updateTime, 
    MQ.createTime as createTime,
    M.memberEmail as memberEmail,
    M.memberName as memberName,
    CBA.companyBankAccountNo as companyBankAccountNo, 
    CBA.bankName as bankName, 
    CBA.bankAccount as bankAccount, 
    CBA.bankOwnerName as bankOwnerName
  </sql>
  
    <sql id="default_membershipRequest_Column_List">
    membershipRequestNo as membershipRequestNo, 
    companyBankAccountNo as companyBankAccountNo,
    memberNo as memberNo, 
    paymentAmount as paymentAmount, 
    paymentStatus as paymentStatus , 
    depositor as depositor, 
    gradeType as gradeType, 
    paymentType as paymentType, 
    regType as regType, 
    regAdminNo as regAdminNo, 
    updateTime as updateTime, 
    createTime as createTime
  </sql>
  
  <sql id="default_membershipRequestSearchWhereStatement">
      <if test="membershipRequestNo != null"> AND membershipRequestNo = #{membershipRequestNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="companyBankAccountNo != null"> AND companyBankAccountNo = #{companyBankAccountNo,jdbcType=INTEGER} </if>
      <if test="paymentAmount != null"> AND paymentAmount = #{paymentAmount,jdbcType=INTEGER}  </if>
      <if test="depositor != null"> AND depositor = #{depositor,jdbcType=CHAR}  </if>
      <if test="paymentStatus != null and paymentStatus != '0'  and paymentStatus != 0 "> AND paymentStatus = #{paymentStatus,jdbcType=CHAR}  </if>
      <if test="gradeType != null and gradeType !=  '0'  and gradeType !=  0  "> AND gradeType = #{gradeType,jdbcType=VARCHAR}  </if>
      <if test="paymentType != null and paymentType != '0'  and paymentType != 0 "> AND paymentType = #{paymentType,jdbcType=VARCHAR}  </if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR}  </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER}  </if>
  </sql>
  
  
  <sql id="membershipRequestCommand_WhereStatement">
      <if test="membershipRequestNo != null"> AND membershipRequestNo = #{membershipRequestNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="paymentAmount != null"> AND paymentAmount = #{paymentAmount,jdbcType=INTEGER}  </if>
       <if test="depositor != null"> AND depositor = #{depositor,jdbcType=CHAR}  </if>
      <if test="paymentStatus != null and paymentStatus != '0'  and paymentStatus != 0 "> AND paymentStatus = #{paymentStatus,jdbcType=CHAR}  </if>
      <if test="gradeType != null and gradeType !=  '0'  and gradeType !=  0  "> AND gradeType = #{gradeType,jdbcType=VARCHAR}  </if>
      <if test="paymentType != null and paymentType != '0'  and paymentType != 0 "> AND paymentType = #{paymentType,jdbcType=VARCHAR}  </if>
      <if test="regType != null"> AND regType = #{regType,jdbcType=CHAR}  </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER}  </if>
      <if test="memberName != null or memberEmail != null ">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">  OR M.memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null"> OR M.memberEmail  LIKE CONCAT('%',#{memberEmail},'%') </if>
     <if test="memberName != null or memberEmail != null ">
      	)
      </if>
  </sql>
  
    <select id="findMembershipRequest" parameterType="com.returnp.admin.model.MembershipRequest"  resultMap="default_membershipRequestResultMap"  >
    select 
    <include refid="default_membershipRequest_Column_List" />
    from membership_request
    where 
    	1 = 1
		<include refid = "default_membershipRequestSearchWhereStatement"/>
  </select>

  <select id="findMembershipRequests" parameterType="com.returnp.admin.dto.request.SearchCondition"  resultMap="membershipRequestCommand_ResultMap" >
    select 
    <include refid="membershipRequestCommand_Column_List" />
    from membership_request as MQ
    inner join company_bank_account as CBA on (MQ.companyBankAccountNo = CBA.companyBankAccountNo)
    inner join member as M on (MQ.memberNo = M.memberNo)
    where 
    	1 = 1
		<include refid = "membershipRequestCommand_WhereStatement"/>
  </select>
  
  
  <select id="findMembershipRequestCommands" parameterType="com.returnp.admin.dto.command.MembershipRequestCommand"  resultMap="membershipRequestCommand_ResultMap" >
    select 
    <include refid="membershipRequestCommand_Column_List" />
    from membership_request as MQ
    inner join company_bank_account as CBA on (MQ.companyBankAccountNo = CBA.companyBankAccountNo)
    inner join member as M on (MQ.memberNo = M.memberNo)
    where 
    	1 = 1
		<include refid = "membershipRequestCommand_WhereStatement"/>
  </select>
  
    <select id="findMembershipRequestCommand" parameterType="com.returnp.admin.dto.command.MembershipRequestCommand"  resultMap="membershipRequestCommand_ResultMap" >
    select 
    <include refid="membershipRequestCommand_Column_List" />
    from membership_request as MQ
    inner join company_bank_account as CBA on (MQ.companyBankAccountNo = CBA.companyBankAccountNo)
    inner join member as M on (MQ.memberNo = M.memberNo)
    where 
    	1 = 1
		<include refid = "membershipRequestCommand_WhereStatement"/>
  </select>
  
  
  
    <!-- ===============================================================================================================    -->
  <!-- CompanyBancAccount  find Mapper -->
  
  <resultMap id="BankResultMap" type="com.returnp.admin.model.CompanyBankAccount">
    <id column="companyBankAccountNo" jdbcType="INTEGER" property="companyBankAccountNo" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="bankName" jdbcType="VARCHAR" property="bankName" />
    <result column="bankOwnerName" jdbcType="VARCHAR" property="bankOwnerName" />
    <result column="bankAccount" jdbcType="VARCHAR" property="bankAccount" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
  <sql id="Bank_Column_List">
    companyBankAccountNo, regAdminNo, bankName, bankOwnerName, bankAccount, createTime, 
    updateTime
  </sql>
  
  <select id="findCompanyBanks" parameterType="com.returnp.admin.model.CompanyBankAccount"  resultMap="BankResultMap" >
    select 
    <include refid="Bank_Column_List" />
    from company_bank_account
    where 
    	1 = 1
  </select>
  
   <!-- ===============================================================================================================    -->
  <!-- PaymentTransaction  find Mapper -->
  
  <resultMap id="PaymentTransaction_ResultMap" type="com.returnp.admin.model.PaymentTransaction">
    <id column="paymentTransactionNo" jdbcType="INTEGER" property="paymentTransactionNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
    <result column="nodeNo" jdbcType="INTEGER" property="nodeNo" />
    <result column="nodeEmail" jdbcType="VARCHAR" property="nodeEmail" />
    <result column="nodeName" jdbcType="VARCHAR" property="nodeName" />
    <result column="nodePhone" jdbcType="VARCHAR" property="nodePhone" />
    <result column="affiliateNo" jdbcType="INTEGER" property="affiliateNo" />
    <result column="affiliateSerial" jdbcType="VARCHAR" property="affiliateSerial" />
    <result column="paymentApprovalAmount" jdbcType="INTEGER" property="paymentApprovalAmount" />
    <result column="paymentApprovalNumber" jdbcType="VARCHAR" property="paymentApprovalNumber" />
    <result column="paymentApprovalStatus" jdbcType="CHAR" property="paymentApprovalStatus" />
    <result column="pointBackStatus" jdbcType="VARCHAR" property="pointBackStatus" />
    <result column="paymentTransactionType" jdbcType="VARCHAR" property="paymentTransactionType" />
    <result column="paymentApprovalDateTime" jdbcType="TIMESTAMP" property="paymentApprovalDateTime" />
    <result column="orgPaymentData" jdbcType="VARCHAR" property="orgPaymentData" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>

  <resultMap id="PaymentTransactionCommand_ResultMap" type="com.returnp.admin.dto.command.PaymentTransactionCommand">
    <id column="paymentTransactionNo" jdbcType="INTEGER" property="paymentTransactionNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
    <result column="nodeNo" jdbcType="INTEGER" property="nodeNo" />
    <result column="nodeEmail" jdbcType="VARCHAR" property="nodeEmail" />
    <result column="nodeName" jdbcType="VARCHAR" property="nodeName" />
    <result column="nodePhone" jdbcType="VARCHAR" property="nodePhone" />
    <result column="affiliateNo" jdbcType="INTEGER" property="affiliateNo" />
    <result column="affiliateSerial" jdbcType="VARCHAR" property="affiliateSerial" />
    <result column="affiliateName" jdbcType="VARCHAR" property="affiliateName" />
    <result column="paymentApprovalAmount" jdbcType="INTEGER" property="paymentApprovalAmount" />
    <result column="paymentApprovalNumber" jdbcType="VARCHAR" property="paymentApprovalNumber" />
    <result column="paymentApprovalStatus" jdbcType="CHAR" property="paymentApprovalStatus" />
    <result column="pointBackStatus" jdbcType="VARCHAR" property="pointBackStatus" />
    <result column="paymentTransactionType" jdbcType="VARCHAR" property="paymentTransactionType" />
    <result column="paymentApprovalDateTime" jdbcType="TIMESTAMP" property="paymentApprovalDateTime" />
    <result column="orgPaymentData" jdbcType="VARCHAR" property="orgPaymentData" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
  <sql id="PaymentTransaction_Column_List">
  paymentTransactionNo, memberNo, memberName, memberPhone, memberEmail, nodeType, nodeNo, 
    nodeEmail, nodeName, nodePhone, affiliateNo, affiliateSerial, paymentApprovalAmount, 
    paymentApprovalNumber, paymentApprovalStatus, pointBackStatus, paymentTransactionType, 
    paymentApprovalDateTime, orgPaymentData, regAdminNo, createTime, updateTime
  </sql>
  
    <sql id="PaymentTransactionCommand_Column_List">
  	PA.paymentTransactionNo, 
  	PA.memberNo, 
  	PA.memberName, 
  	PA.memberPhone, 
  	PA.memberEmail, 
  	PA.nodeType, 
  	PA.nodeNo, 
    PA.nodeEmail, 
    PA.nodeName, 
    PA.nodePhone, 
    PA.affiliateNo, 
    PA.affiliateSerial, 
    AF.affiliateName, 
    PA.paymentApprovalAmount, 
    PA.paymentApprovalNumber, 
    PA.paymentApprovalStatus, 
    PA.pointBackStatus, 
    PA.paymentTransactionType, 
    PA.paymentApprovalDateTime, 
    PA.orgPaymentData, 
    PA.regAdminNo, 
    PA.createTime, 
    PA.updateTime
  </sql>
  
  
    <sql id="PaymentTransaction_Where">
      <if test="paymentTransactionNo != null"> AND paymentTransactionNo = #{paymentTransactionNo,jdbcType=INTEGER}</if>
      <if test="memberNo != null"> AND memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="affiliateNo != null"> AND affiliateNo = #{affiliateNo,jdbcType=INTEGER}  </if>
      <if test="paymentApprovalAmount != null"> AND paymentApprovalAmount = #{paymentApprovalAmount,jdbcType=INTEGER} </if>
      <if test="paymentApprovalNumber != null"> AND paymentApprovalNumber = #{paymentApprovalNumber,jdbcType=INTEGER} </if>
      <if test="pointBackStatus != null"> AND pointBackStatus = #{pointBackStatus,jdbcType=INTEGER} </if>
      <if test="paymentApprovalStatus != null"> AND paymentApprovalStatus = #{paymentApprovalStatus,jdbcType=CHAR} </if>
      <if test="paymentTransactionType != null"> AND paymentTransactionType = #{paymentTransactionType,jdbcType=VARCHAR} </if>
      <if test="affiliateSerial != null"> AND affiliateSerial = #{affiliateSerial,jdbcType=VARCHAR} </if>
      <if test="paymentApprovalDateTime != null"> AND paymentApprovalDateTime = #{paymentApprovalDateTime,jdbcType=TIMESTAMP} </if>
      <if test="regAdminNo != null"> AND regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
       
       <if test="memberName != null or memberEmail != null  or memberPhone != null ">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">  OR memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null"> OR memberEmail  LIKE CONCAT('%',#{memberEmail},'%') </if>
      <if test="memberPhone != null"> OR memberPhone  LIKE CONCAT('%',#{memberPhone},'%') </if>
      <if test="memberName != null or memberEmail != null  or memberPhone != null ">
      	)
      </if>
  </sql>

    <sql id="PaymentTransactionCommand_Where">
      <if test="paymentTransactionNo != null"> AND PA.paymentTransactionNo = #{paymentTransactionNo,jdbcType=INTEGER}</if>
      <if test="memberNo != null"> AND PA.memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="affiliateNo != null"> AND PA.affiliateNo = #{affiliateNo,jdbcType=INTEGER}  </if>
      <if test="paymentApprovalAmount != null"> AND PA.paymentApprovalAmount = #{paymentApprovalAmount,jdbcType=INTEGER} </if>
      <if test="paymentApprovalNumber != null"> AND PA.paymentApprovalNumber = #{paymentApprovalNumber,jdbcType=INTEGER} </if>
      <if test="pointBackStatus != null"> AND PA.pointBackStatus = #{pointBackStatus,jdbcType=INTEGER} </if>
      <if test="paymentApprovalStatus != null"> AND PA.paymentApprovalStatus = #{paymentApprovalStatus,jdbcType=CHAR} </if>
      <if test="paymentTransactionType != null"> AND PA.paymentTransactionType = #{paymentTransactionType,jdbcType=VARCHAR} </if>
      <if test="affiliateSerial != null"> AND PA.affiliateSerial = #{affiliateSerial,jdbcType=VARCHAR} </if>
      <if test="paymentApprovalDateTime != null"> AND PA.paymentApprovalDateTime = #{paymentApprovalDateTime,jdbcType=TIMESTAMP} </if>
      <if test="regAdminNo != null"> AND PA.regAdminNo = #{regAdminNo,jdbcType=INTEGER} </if>
       
       <if test="memberName != null or memberEmail != null  or memberPhone != null ">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">  OR PA.memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null"> OR PA.memberEmail  LIKE CONCAT('%',#{memberEmail},'%') </if>
      <if test="memberPhone != null"> OR PA.memberPhone  LIKE CONCAT('%',#{memberPhone},'%') </if>
      <if test="memberName != null or memberEmail != null  or memberPhone != null ">
      	)
      </if>
  </sql>
  
  <select id="findPaymentTransactions" parameterType="com.returnp.admin.model.PaymentTransaction"  resultMap="PaymentTransaction_ResultMap" >
    select 
    <include refid="PaymentTransaction_Column_List" />
    from payment_transaction
    where 
    	1 = 1
    	<include refid = "PaymentTransaction_Where"/>
		<include refid = "commonStatement"/>    	
  </select>
  
   <select id="findPaymentTransactionCommands" parameterType="com.returnp.admin.model.PaymentTransaction"  resultMap="PaymentTransactionCommand_ResultMap" >
    select 
    sql_calc_found_rows
    <include refid="PaymentTransactionCommand_Column_List" />
    from payment_transaction as PA
    inner join affiliate as AF on (PA.affiliateSerial= AF.affiliateSerial)
    where 
    	1 = 1
    	<include refid = "PaymentTransactionCommand_Where"/>
    	<include refid = "commonStatement"/>   
  </select>
  
  
  <!-- ===============================================================================================================    -->
  <!-- GreenPointCommand  find Mapper -->
  
    <resultMap id="GreenPoint_ResultMap" type="com.returnp.admin.model.GreenPoint">
    <id column="greenPointNo" jdbcType="INTEGER" property="greenPointNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="nodeNo" jdbcType="INTEGER" property="nodeNo" />
    <result column="pointAmount" jdbcType="REAL" property="pointAmount" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
      <result column="nodeTypeName" jdbcType="VARCHAR" property="nodeTypeName" />
    <result column="greenPointCreateTime" jdbcType="TIMESTAMP" property="greenPointCreateTime" />
    <result column="greenPointUpdateTime" jdbcType="TIMESTAMP" property="greenPointUpdateTime" />
  </resultMap>
  
  <resultMap id="GreenPointCommand_ResultMap" type="com.returnp.admin.dto.command.GreenPointCommand">
    <id column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberPassword" jdbcType="VARCHAR" property="memberPassword" />
    <result column="memberPassword2" jdbcType="VARCHAR" property="memberPassword2" />
    <result column="memberType" jdbcType="VARCHAR" property="memberType" />
    <result column="memberStatus" jdbcType="VARCHAR" property="memberStatus" />
    <result column="memberAuthType" jdbcType="VARCHAR" property="memberAuthType" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="joinRoute" jdbcType="VARCHAR" property="joinRoute" />
    <result column="statusReason" jdbcType="VARCHAR" property="statusReason" />
    <result column="isRecommender" jdbcType="CHAR" property="isRecommender" />
    <result column="isSaleManager" jdbcType="CHAR" property="isSaleManager" />
    <result column="isBranch" jdbcType="CHAR" property="isBranch" />
    <result column="isAffiliate" jdbcType="CHAR" property="isAffiliate" />
    <result column="isAgency" jdbcType="CHAR" property="isAgency" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    
     <result column="greenPointNo" jdbcType="INTEGER" property="greenPointNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="nodeNo" jdbcType="INTEGER" property="nodeNo" />
    <result column="pointAmount" jdbcType="REAL" property="pointAmount" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
     <result column="nodeTypeName" jdbcType="VARCHAR" property="nodeTypeName" />
    <result column="greenPointCreateTime" jdbcType="TIMESTAMP" property="greenPointCreateTime" />
    <result column="greenPointUpdateTime" jdbcType="TIMESTAMP" property="greenPointUpdateTime" />
  </resultMap>
  
    <sql id="GreenPoint_Column_List">
    greenPointNo, memberNo, nodeNo, pointAmount, nodeType, nodeTypeName, greenPointCreateTime, greenPointUpdateTime
  </sql>
  
  <sql id="GreenPointCommand_ResultMap_Column_List">
	M.memberNo AS memberNo, 
    M.memberName AS memberName,  
    M.memberEmail AS memberEmail, 
    M.memberPassword AS memberPassword, 
    M.memberPassword2 AS memberPassword2, 
    M.memberType AS memberType, 
    M.memberStatus AS memberStatus, 
    M.memberAuthType AS memberAuthType, 
    M.memberPhone AS memberPhone, 
    M.recommenderNo AS recommenderNo, 
    M.joinRoute AS joinRoute, 
    M.statusReason AS statusReason, 
    M.isRecommender AS isRecommender, 
    M.isSaleManager AS isSaleManager,
    M.isBranch AS isBranch,
    M.isAffiliate AS isAffiliate, 
    M.isAgency AS isAgency, 
    M.regType AS regType, 
    M.regAdminNo AS regAdminNo, 
    M.greenPointAccStatus AS greenPointAccStatus, 
    M.redPointAccStatus AS redPointAccStatus, 
    M.greenPointUseStatus AS greenPointUseStatus, 
    M.redPointUseStatus AS redPointUseStatus, 
    M.createTime  AS createTime, 
    M.updateTime AS updateTime,
    
    GP.greenPointNo as greenPointNo, 
    GP.memberNo as memberNo, 
    GP.nodeNo as nodeNo, 
    GP.pointAmount as pointAmount,
    GP.nodeType as nodeType, 
    GP.nodeTypeName as nodeTypeName,
    GP.greenPointCreateTime as greenPointCreateTime,
	GP.greenPointUpdateTime as greenPointUpdateTime

  </sql>
  
      <sql id="GreenPoint_Where">
      <if test="greenPointNo != null and greenPointNo !=  '0'  and greenPointNo !=  0">AND  greenPointNo = #{greenPointNo,jdbcType=VARCHAR}</if>
     <if test="memberNo != null and memberNo !=  '0'  and memberNo !=  0">AND  memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="nodeType != null and nodeType !=  '0'  and nodeType !=  0">AND  nodeType = #{nodeType,jdbcType=VARCHAR}</if>
      <if test="nodeNo != null and nodeNo !=  '0'  and nodeNo !=  0">AND  nodeNo = #{nodeNo,jdbcType=VARCHAR}</if>
  </sql>
  
    <sql id="GreenPointCommand_Where">
     <if test="memberNo != null and memberNo !=  '0'  and memberNo !=  0">AND  M.memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="memberType != null">AND  M.memberType = #{memberType,jdbcType=VARCHAR}</if>
      <if test="memberStatus != null and memberStatus !=  '0'  and memberStatus !=  0">AND  M.memberStatus = #{memberStatus,jdbcType=VARCHAR}</if>
      <if test="memberAuthType != null">AND  M.memberAuthType = #{memberAuthType,jdbcType=VARCHAR}</if>
      <if test="recommenderNo != null">AND  M.recommenderNo = #{recommenderNo,jdbcType=INTEGER}</if>
      <if test="joinRoute != null">AND  M.joinRoute = #{joinRoute,jdbcType=VARCHAR}</if>
      <if test="isRecommender != null">AND  M.isRecommender = #{isRecommender,jdbcType=CHAR}</if>
      <if test="isSaleManager != null"> M.isSaleManager = #{isSaleManager,jdbcType=CHAR}</if>
      <if test="isBranch != null">AND  M.isBranch = #{isBranch,jdbcType=CHAR}</if>
      <if test="isAffiliate != null">AND  M.isAffiliate = #{isAffiliate,jdbcType=CHAR}</if>
      <if test="isAgency != null">AND  M.isAgency = #{isAgency,jdbcType=CHAR}</if>
      <if test="regType != null">AND  M.regType = #{regType,jdbcType=CHAR}</if>
      <if test="regAdminNo != null">AND  M.regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="greenPointAccStatus != null">AND  M.greenPointAccStatus = #{greenPointAccStatus,jdbcType=CHAR}</if>
      <if test="redPointAccStatus != null">AND  M.redPointAccStatus = #{redPointAccStatus,jdbcType=CHAR}</if>
      <if test="greenPointUseStatus != null">AND  M.greenPointUseStatus = #{greenPointUseStatus,jdbcType=CHAR}</if>
      <if test="redPointUseStatus != null">AND  M.redPointUseStatus = #{redPointUseStatus,jdbcType=CHAR}</if>
      <if test="redPointUseStatus != null">AND  M.redPointUseStatus = #{redPointUseStatus,jdbcType=CHAR}</if>
      
      <if test="greenPointNo != null and greenPointNo !=  '0'  and greenPointNo !=  0">AND  GP.greenPointNo = #{greenPointNo,jdbcType=VARCHAR}</if>
      <if test="nodeType != null and nodeType !=  '0'  and nodeType !=  0">AND  GP.nodeType = #{nodeType,jdbcType=VARCHAR}</if>
      <if test="nodeNo != null and nodeNo !=  '0'  and nodeNo !=  0">AND  GP.nodeNo = #{nodeNo,jdbcType=VARCHAR}</if>

      <if test="memberName != null or memberEmail != null or memberPhone != null or statusReason != null">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">OR M.memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null">OR M.memberEmail  LIKE CONCAT('%',#{memberEmail},'%' ) </if>
      <if test="memberPhone != null">OR M.memberPhone  LIKE CONCAT('%',#{memberPhone},'%') </if>
      <if test="statusReason != null">OR  M.statusReason = #{statusReason,jdbcType=VARCHAR}</if>
      <if test="memberName != null or memberEmail != null or memberPhone != null or statusReason != null">
      	)
      </if>
  </sql>
  
   <select id="findGreenPoints" parameterType="com.returnp.admin.model.GreenPoint"  resultMap="GreenPoint_ResultMap" >
    select 
    <include refid="GreenPoint_Column_List" />
    from green_point 
    where 
    	1 = 1
    	<include refid = "GreenPoint_Where"/>
  </select>

  <select id="findGreenPointCommands" parameterType="com.returnp.admin.dto.command.GreenPointCommand"  resultMap="GreenPointCommand_ResultMap" >
    select 
    sql_calc_found_rows
    <include refid="GreenPointCommand_ResultMap_Column_List" />
    from green_point as GP
 	inner join member as M on (
    	GP.memberNo = M.memberNo 
    )
    where 
    	1 = 1
    	<include refid = "GreenPointCommand_Where"/>
    	<include refid = "commonStatement"/>
  </select>
  
  
  
  
  <!-- ===============================================================================================================    -->
  <!-- RedPointCommand  find Mapper -->
  
  <resultMap id="RedPointCommand_ResultMap" type="com.returnp.admin.dto.command.RedPointCommand">
    <id column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberPassword" jdbcType="VARCHAR" property="memberPassword" />
    <result column="memberPassword2" jdbcType="VARCHAR" property="memberPassword2" />
    <result column="memberType" jdbcType="VARCHAR" property="memberType" />
    <result column="memberStatus" jdbcType="VARCHAR" property="memberStatus" />
    <result column="memberAuthType" jdbcType="VARCHAR" property="memberAuthType" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="joinRoute" jdbcType="VARCHAR" property="joinRoute" />
    <result column="statusReason" jdbcType="VARCHAR" property="statusReason" />
    <result column="isRecommender" jdbcType="CHAR" property="isRecommender" />
    <result column="isSaleManager" jdbcType="CHAR" property="isSaleManager" />
    <result column="isBranch" jdbcType="CHAR" property="isBranch" />
    <result column="isAffiliate" jdbcType="CHAR" property="isAffiliate" />
    <result column="isAgency" jdbcType="CHAR" property="isAgency" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    
     <result column="redPointNo" jdbcType="INTEGER" property="redPointNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="pointAmount" jdbcType="REAL" property="pointAmount" />
    <result column="redPointCreateTime" jdbcType="TIMESTAMP" property="redPointCreateTime" />
    <result column="redPointUpdateTime" jdbcType="TIMESTAMP" property="redPointUpdateTime" />
  </resultMap>
  
    <resultMap id="RedPoint_ResultMap" type="com.returnp.admin.model.RedPoint">
    <id column="redPointNo" jdbcType="INTEGER" property="redPointNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="pointAmount" jdbcType="REAL" property="pointAmount" />
    <result column="redPointCreateTime" jdbcType="TIMESTAMP" property="redPointCreateTime" />
    <result column="redPointUpdateTime" jdbcType="TIMESTAMP" property="redPointUpdateTime" />
  </resultMap>
  
   <sql id="RedPoint_Column_List">
    redPointNo, memberNo, pointAmount, redPointCreateTime, redPointUpdateTime
  </sql>
  
  <sql id="RedPointCommand_Column_List">
	M.memberNo AS memberNo, 
    M.memberName AS memberName,  
    M.memberEmail AS memberEmail, 
    M.memberPassword AS memberPassword, 
    M.memberPassword2 AS memberPassword2, 
    M.memberType AS memberType, 
    M.memberStatus AS memberStatus, 
    M.memberAuthType AS memberAuthType, 
    M.memberPhone AS memberPhone, 
    M.recommenderNo AS recommenderNo, 
    M.joinRoute AS joinRoute, 
    M.statusReason AS statusReason, 
    M.isRecommender AS isRecommender, 
    M.isSaleManager AS isSaleManager,
    M.isBranch AS isBranch,
    M.isAffiliate AS isAffiliate, 
    M.isAgency AS isAgency, 
    M.regType AS regType, 
    M.regAdminNo AS regAdminNo, 
    M.greenPointAccStatus AS greenPointAccStatus, 
    M.redPointAccStatus AS redPointAccStatus, 
    M.greenPointUseStatus AS greenPointUseStatus, 
    M.redPointUseStatus AS redPointUseStatus, 
    M.createTime  AS createTime, 
    M.updateTime AS updateTime,
    
    RP.redPointNo as redPointNo, 
    RP.memberNo as memberNo, 
    RP.pointAmount as pointAmount,
    RP.redPointCreateTime as redPointCreateTime,
	RP.redPointUpdateTime as redPointUpdateTime

  </sql>
  
  <sql id="RedPoint_Where">
     <if test="memberNo != null and memberNo !=  '0'  and memberNo !=  0">AND  memberNo = #{memberNo,jdbcType=INTEGER}</if>
 	<if test="redPointNo != null and redPointNo !=  '0'  and redPointNo !=  0">AND  redPointNo = #{redPointNo,jdbcType=VARCHAR}</if>
  </sql>
  
    <sql id="RedPointCommand_Where">
     <if test="memberNo != null">AND  M.memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="memberType != null">AND  memberType = #{memberType,jdbcType=VARCHAR}</if>
      <if test="memberStatus != null and memberStatus !=  '0'  and memberStatus !=  0">AND  memberStatus = #{memberStatus,jdbcType=VARCHAR}</if>
      <if test="memberAuthType != null">AND  memberAuthType = #{memberAuthType,jdbcType=VARCHAR}</if>
      <if test="recommenderNo != null">AND  recommenderNo = #{recommenderNo,jdbcType=INTEGER}</if>
      <if test="joinRoute != null">AND  joinRoute = #{joinRoute,jdbcType=VARCHAR}</if>
      <if test="isRecommender != null">AND  isRecommender = #{isRecommender,jdbcType=CHAR}</if>
      <if test="isSaleManager != null"> isSaleManager = #{isSaleManager,jdbcType=CHAR}</if>
      <if test="isBranch != null">AND  isBranch = #{isBranch,jdbcType=CHAR}</if>
      <if test="isAffiliate != null">AND  isAffiliate = #{isAffiliate,jdbcType=CHAR}</if>
      <if test="isAgency != null">AND  isAgency = #{isAgency,jdbcType=CHAR}</if>
      <if test="regType != null">AND  regType = #{regType,jdbcType=CHAR}</if>
      <if test="regAdminNo != null">AND  regAdminNo = #{regAdminNo,jdbcType=INTEGER}</if>
      <if test="greenPointAccStatus != null">AND  greenPointAccStatus = #{greenPointAccStatus,jdbcType=CHAR}</if>
      <if test="redPointAccStatus != null">AND  redPointAccStatus = #{redPointAccStatus,jdbcType=CHAR}</if>
      <if test="greenPointUseStatus != null">AND  greenPointUseStatus = #{greenPointUseStatus,jdbcType=CHAR}</if>
      <if test="redPointUseStatus != null">AND  redPointUseStatus = #{redPointUseStatus,jdbcType=CHAR}</if>
      
 		<if test="redPointNo != null and redPointNo !=  '0'  and redPointNo !=  0">AND  RP.redPointNo = #{redPointNo,jdbcType=VARCHAR}</if>

      <if test="memberName != null or memberEmail != null or memberPhone != null or statusReason != null">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">OR M.memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null">OR M.memberEmail  LIKE CONCAT('%',#{memberEmail},'%' ) </if>
      <if test="memberPhone != null">OR M.memberPhone  LIKE CONCAT('%',#{memberPhone},'%') </if>
      <if test="statusReason != null">OR  M.statusReason = #{statusReason,jdbcType=VARCHAR}</if>
      <if test="memberName != null or memberEmail != null or memberPhone != null or statusReason != null">
      	)
      </if>
  </sql>
  
  <select id="findRedPointCommands" parameterType="com.returnp.admin.dto.command.RedPointCommand"  resultMap="RedPointCommand_ResultMap" >
    select 
    sql_calc_found_rows
    <include refid="RedPointCommand_Column_List" />
    from red_point as RP
 	inner join member as M on (
    	RP.memberNo = M.memberNo 
    )
    where 
    	1 = 1
    	<include refid = "RedPointCommand_Where"/>
    	<include refid = "commonStatement"/>
  </select>
  
  <select id="findRedPoints" parameterType="com.returnp.admin.model.RedPoint"  resultMap="RedPoint_ResultMap" >
    select 
    <include refid="RedPoint_Column_List" />
    from red_point 
    where 
    	1 = 1
    	<include refid = "RedPoint_Where"/>
  </select>
  
  
  <!-- ===============================================================================================================    -->
  <!-- PointConvertRequestCommand  find Mapper -->
  
  <resultMap id="PointConvertRequestCommand_ResultMap" type="com.returnp.admin.dto.command.PointConvertRequestCommand">
    <id column="pointConvertRequestNo" jdbcType="INTEGER" property="pointConvertRequestNo" />
    <result column="rmemberNo" jdbcType="INTEGER" property="rmemberNo" />
    <result column="greenPointNo" jdbcType="INTEGER" property="greenPointNo" />
    <result column="pointAmount" jdbcType="REAL" property="pointAmount" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
    <result column="requestNodeTypeName" jdbcType="VARCHAR" property="requestNodeTypeName" />
    <result column="convertPointAmount" jdbcType="REAL" property="convertPointAmount" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />  		

    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
  </resultMap>
  
  <sql id="PointConvertRequestCommand_Column_List">
    PCR.pointConvertRequestNo as pointConvertRequestNo, 
    PCR.memberNo as memberNo, 
    PCR.greenPointNo as greenPointNo, 
    GP.pointAmount as pointAmount, 
    PCR.nodeType as nodeType, 
    PCR.requestNodeTypeName as requestNodeTypeName, 
    PCR.convertPointAmount as convertPointAmount, 
    PCR.createTime as createTime, 
    PCR.updateTime as updateTime,
    M.memberEmail as memberEmail,
    M.memberName as memberName,
    M.memberPhone as memberPhone
  </sql>
  
   <sql id="PointConvertRequestCommand_Where">
       <if test="pointConvertRequestNo != null and pointConvertRequestNo !=  '0'  and pointConvertRequestNo !=  0">AND PCR.pointConvertRequestNo = #{pointConvertRequestNo,jdbcType=INTEGER} </if>
       <if test="memberNo != null and memberNo !=  '0'  and memberNo !=  0">AND PCR.memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="greenPointNo != null and greenPointNo !=  '0'  and greenPointNo !=  0">AND  PCR.greenPointNo = #{greenPointNo,jdbcType=INTEGER} </if>
       <if test="memberName != null or memberEmail != null or memberPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">OR M.memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null">OR M.memberEmail  LIKE CONCAT('%',#{memberEmail},'%' ) </if>
      <if test="memberPhone != null">OR M.memberPhone  LIKE CONCAT('%',#{memberPhone},'%') </if>
      <if test="memberName != null or memberEmail != null or memberPhone != null">
      	)
      </if>
  </sql>
  
  <select id="findPointConvertRequestCommands" parameterType="com.returnp.admin.dto.command.PointConvertRequestCommand"  resultMap="PointConvertRequestCommand_ResultMap" >
    select 
    <include refid="PointConvertRequestCommand_Column_List" />
    from point_convert_request as PCR
 	inner join member as M on (
    	PCR.memberNo = M.memberNo 
    )
    inner join green_point as GP on (
    	PCR.greenPointNo = GP.greenPointNo 
    )
    where 
    	1 = 1
    	<include refid = "PointConvertRequestCommand_Where"/>
  </select>
  
    <!-- ===============================================================================================================    -->
     <!-- PointConversionTransactionCommand  find Mapper -->
    
    <resultMap id="PointConversionTransactionCommand_ResultMap" type="com.returnp.admin.dto.command.PointConversionTransactionCommand">
    <id column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="memberPassword" jdbcType="VARCHAR" property="memberPassword" />
    <result column="memberPassword2" jdbcType="VARCHAR" property="memberPassword2" />
    <result column="memberType" jdbcType="VARCHAR" property="memberType" />
    <result column="memberStatus" jdbcType="VARCHAR" property="memberStatus" />
    <result column="memberAuthType" jdbcType="VARCHAR" property="memberAuthType" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="recommenderNo" jdbcType="INTEGER" property="recommenderNo" />
    <result column="joinRoute" jdbcType="VARCHAR" property="joinRoute" />
    <result column="statusReason" jdbcType="VARCHAR" property="statusReason" />
    <result column="isRecommender" jdbcType="CHAR" property="isRecommender" />
    <result column="isSaleManager" jdbcType="CHAR" property="isSaleManager" />
    <result column="isBranch" jdbcType="CHAR" property="isBranch" />
    <result column="isAffiliate" jdbcType="CHAR" property="isAffiliate" />
    <result column="isAgency" jdbcType="CHAR" property="isAgency" />
    <result column="regType" jdbcType="CHAR" property="regType" />
    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
    <result column="greenPointAccStatus" jdbcType="CHAR" property="greenPointAccStatus" />
    <result column="redPointAccStatus" jdbcType="CHAR" property="redPointAccStatus" />
    <result column="greenPointUseStatus" jdbcType="CHAR" property="greenPointUseStatus" />
    <result column="redPointUseStatus" jdbcType="CHAR" property="redPointUseStatus" />
    
    <result column="pointConversionTansactionNo" jdbcType="INTEGER" property="pointConversionTansactionNo" />
    <result column="conversionTotalPoint" jdbcType="REAL" property="conversionTotalPoint" />
    <result column="conversionAccPoint" jdbcType="REAL" property="conversionAccPoint" />
    <result column="conversionAccRate" jdbcType="REAL" property="conversionAccRate" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
    <result column="conversionStatus" jdbcType="VARCHAR" property="conversionStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
  <resultMap id="PointConversionTransaction_ResultMap" type="com.returnp.admin.model.PointConversionTransaction">
     <id column="pointConversionTansactionNo" jdbcType="INTEGER" property="pointConversionTansactionNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="conversionTotalPoint" jdbcType="REAL" property="conversionTotalPoint" />
    <result column="conversionAccPoint" jdbcType="REAL" property="conversionAccPoint" />
    <result column="conversionAccRate" jdbcType="REAL" property="conversionAccRate" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
    <result column="conversionStatus" jdbcType="VARCHAR" property="conversionStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
  
  <sql id="PointConversionTransactionCommand_Column_List">
    M.memberName AS memberName,  
    M.memberEmail AS memberEmail, 
    M.memberPassword AS memberPassword, 
    M.memberPassword2 AS memberPassword2, 
    M.memberType AS memberType, 
    M.memberStatus AS memberStatus, 
    M.memberAuthType AS memberAuthType, 
    M.memberPhone AS memberPhone, 
    M.recommenderNo AS recommenderNo, 
    M.joinRoute AS joinRoute, 
    M.statusReason AS statusReason, 
    M.isRecommender AS isRecommender, 
    M.isSaleManager AS isSaleManager,
    M.isBranch AS isBranch,
    M.isAffiliate AS isAffiliate, 
    M.isAgency AS isAgency, 
    M.regType AS regType, 
    M.regAdminNo AS regAdminNo, 
    M.greenPointAccStatus AS greenPointAccStatus, 
    M.redPointAccStatus AS redPointAccStatus, 
    M.greenPointUseStatus AS greenPointUseStatus, 
    M.redPointUseStatus AS redPointUseStatus, 
    PCT.pointConversionTansactionNo as pointConversionTansactionNo, 
    PCT.memberNo as memberNo,
    PCT.conversionTotalPoint as conversionTotalPoint, 
    PCT.nodeType as nodeType, 
    PCT.conversionTotalPoint as conversionTotalPoint, 
    PCT.conversionAccPoint as conversionAccPoint, 
    PCT.conversionAccRate as conversionAccRate, 
    PCT.conversionStatus as conversionStatus, 
    PCT.createTime as createTime, 
    PCT.updateTime as updateTime
  </sql>
  
    <sql id="PointConversionTransaction_Column_List">
    pointConversionTansactionNo,  memberNo, conversionTotalPoint, conversionAccPoint, 
    conversionAccRate,  conversionStatus, createTime, updateTime
  </sql>
  
   <sql id="PointConversionTransactionCommand_Where">
      <if test="pointConversionTansactionNo != null">AND PCT.pointConversionTansactionNo = #{pointConversionTansactionNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null">AND PCT.memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="nodeType != null">AND  PCT.nodeType = #{nodeType,jdbcType=REAL} </if>
      <if test="conversionTotalPoint != null">AND  PCT.conversionTotalPoint = #{conversionTotalPoint,jdbcType=REAL} </if>
      <if test="conversionAccPoint != null">AND  PCT.conversionAccPoint = #{conversionAccPoint,jdbcType=REAL} </if>
      <if test="conversionAccRate != null">AND  PCT.conversionAccRate = #{conversionAccRate,jdbcType=REAL} </if>
      <if test="conversionStatus != null">AND  PCT.conversionStatus = #{conversionStatus,jdbcType=VARCHAR} </if>
       <if test="memberName != null or memberEmail != null or memberPhone != null">
      	AND ( 1 = 2 
      </if>
      <if test="memberName != null">OR M.memberName  LIKE CONCAT('%',#{memberName},'%') </if>
      <if test="memberEmail != null">OR M.memberEmail  LIKE CONCAT('%',#{memberEmail},'%' ) </if>
      <if test="memberPhone != null">OR M.memberPhone  LIKE CONCAT('%',#{memberPhone},'%') </if>
      <if test="memberName != null or memberEmail != null or memberPhone != null">
      	)
      </if>
  </sql>
  
     <sql id="PointConversionTransaction_Where">
      <if test="pointConversionTansactionNo != null">AND pointConversionTansactionNo = #{pointConversionTansactionNo,jdbcType=INTEGER} </if>
      <if test="memberNo != null">AND memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="nodeType != null">AND  PCT.nodeType = #{nodeType,jdbcType=REAL} </if>
      <if test="conversionTotalPoint != null">AND  conversionTotalPoint = #{conversionTotalPoint,jdbcType=REAL} </if>
      <if test="conversionAccPoint != null">AND  conversionAccPoint = #{conversionAccPoint,jdbcType=REAL} </if>
      <if test="conversionAccRate != null">AND  conversionAccRate = #{conversionAccRate,jdbcType=REAL} </if>
      <if test="conversionStatus != null">AND  PCT.conversionStatus = #{conversionStatus,jdbcType=VARCHAR} </if>
  </sql>
  
   <select id="findPointConversionTransactions" parameterType="com.returnp.admin.model.PointConversionTransaction"  resultMap="PointConversionTransaction_ResultMap" >
    select 
    	<include refid="PointConversionTransaction_Column_List" />
    from point_conversion_transaction 
    where 
    	1 = 1
    	<include refid = "PointConversionTransaction_Where"/>
  </select>
  
   <select id="findPointConversionTransactionCommands" parameterType="com.returnp.admin.dto.command.PointConversionTransactionCommand"  resultMap="PointConversionTransactionCommand_ResultMap" >
    select 
    	sql_calc_found_rows
    	<include refid="PointConversionTransactionCommand_Column_List" />
    from point_conversion_transaction as PCT
 	inner join member as M on (
    	PCT.memberNo = M.memberNo 
    )
    where 
    	1 = 1
    	<include refid = "commonStatement"/>
  </select>
  
   <resultMap id="PaymentPointbackRecordCommand_ResultMap" type="com.returnp.admin.dto.command.PaymentPointbackRecordCommand">
     <id column="paymentPointbackRecordNo" jdbcType="INTEGER" property="paymentPointbackRecordNo" />
    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
    <result column="paymentTransactionNo" jdbcType="INTEGER" property="paymentTransactionNo" />
    <result column="nodeNo" jdbcType="INTEGER" property="nodeNo" />
    <result column="nodeType" jdbcType="VARCHAR" property="nodeType" />
    <result column="pointbackAmount" jdbcType="REAL" property="pointbackAmount" />
    <result column="accRate" jdbcType="REAL" property="accRate" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="mameberName" jdbcType="VARCHAR" property="memberName" />
    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
    <result column="paymentApprovalAmount" jdbcType="REAL" property="paymentApprovalAmount" />
    <result column="affiliateSerial" jdbcType="VARCHAR" property="affiliateSerial" />
    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
    <result column="paymentApprovalDateTime" jdbcType="TIMESTAMP" property="paymentApprovalDateTime" />
  </resultMap>
  <sql id="PaymentPointbackRecordCommand_Column_List">
    PPR.paymentPointbackRecordNo, 
    PPR.memberNo, 
    PPR.paymentTransactionNo, 
    PPR.nodeNo, 
    PPR.nodeType, 
    PPR.accRate, 
    PPR.pointbackAmount, 
    PPR.createTime, 
    PPR.updateTime,
    M.memberName,
    M.memberPhone,
    M.memberEmail,
    VPT.paymentApprovalAmount,
    VPT.affiliateSerial,
    VPT.paymentApprovalDateTime
    
  </sql>
  
    <sql id ="PaymentPointbackRecordCommand_WhereStatement">
	 <if test="paymentPointbackRecordNo != null  and  paymentPointbackRecordNo  != 0"> AND paymentPointbackRecordNo = #{paymentPointbackRecordNo} </if>
	 <if test="memberNo != null "> AND PPR.memberNo = #{memberNo} </if>
	 <if test="paymentTransactionNo != null "> AND PPR.paymentTransactionNo = #{paymentTransactionNo} </if>
	 <if test="nodeNo != null "> AND PPR.nodeNo = #{nodeNo} </if>
	 <if test="nodeType != null "> AND PPR.nodeType = #{nodeType} </if>
	</sql>
	
  <select id="findPaymentPointbackRecordCommands"  parameterType="com.returnp.admin.dto.command.PaymentPointbackRecordCommand"  resultMap="PaymentPointbackRecordCommand_ResultMap" >
    select
    sql_calc_found_rows 
    <include refid="PaymentPointbackRecordCommand_Column_List" />
  	from payment_pointback_record as PPR
  	inner join member as M on (PPR.memberNo = M.memberNo)  
    inner join payment_transaction as  VPT on (PPR.paymentTransactionNo = VPT.paymentTransactionNo)
	where
    	1 = 1
		<include refid = "PaymentPointbackRecordCommand_WhereStatement"/>
		<include refid = "commonStatement"/>
  </select>
  
 
 
  <!-- ===============================================================================================================    -->
     <!-- CategoryCommand  find Mapper -->
    
  <resultMap id="Category_ResultMap" type="com.returnp.admin.model.Category">
     <id column="categoryNo" jdbcType="INTEGER" property="categoryNo" />
    <result column="categoryCode" jdbcType="VARCHAR" property="categoryCode" />
    <result column="parentCategoryNo" jdbcType="INTEGER" property="parentCategoryNo" />
    <result column="categoryLevel" jdbcType="VARCHAR" property="categoryLevel" />
    <result column="categoryName" jdbcType="VARCHAR" property="categoryName" />
    <result column="categoryNameEn" jdbcType="VARCHAR" property="categoryNameEn" />
    <result column="categoryStatus" jdbcType="VARCHAR" property="categoryStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTiem" jdbcType="TIMESTAMP" property="updateTiem" />
  </resultMap>
  
    <resultMap id="CategoryCommand_ResultMap" type="com.returnp.admin.dto.command.CategoryCommand">
     <id column="categoryNo" jdbcType="INTEGER" property="categoryNo" />
    <result column="categoryCode" jdbcType="VARCHAR" property="categoryCode" />
    <result column="parentCategoryNo" jdbcType="INTEGER" property="parentCategoryNo" />
    <result column="parentCategoryName" jdbcType="VARCHAR" property="parentCategoryName" />
    <result column="parentCategoryNameEn" jdbcType="VARCHAR" property="parentCategoryNameEn" />
    <result column="categoryLevel" jdbcType="VARCHAR" property="categoryLevel" />
    <result column="categoryName" jdbcType="VARCHAR" property="categoryName" />
    <result column="categoryNameEn" jdbcType="VARCHAR" property="categoryNameEn" />
    <result column="categoryStatus" jdbcType="VARCHAR" property="categoryStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTiem" jdbcType="TIMESTAMP" property="updateTiem" />
  </resultMap>
  
  
    <sql id="Category_Column_List">
    categoryNo, 
    categoryCode, 
    categoryLevel, 
    categoryName, 
    categoryNameEn, 
    parentCategoryNo, 
    categoryStatus, 
    createTime, 
    updateTime
    
  </sql>
  
   <sql id="CategoryCommand_Column_List">
   C1.categoryNo, 
    C1.categoryCode, 
    C1.categoryLevel, 
    C1.categoryName, 
    C1.categoryNameEn, 
    C1.parentCategoryNo, 
    C2.categoryName as parentCategoryName,
    C2.categoryNameEn as parentCategoryNameEn, 
    C1.categoryStatus, 
    C1.createTime, 
    C1.updateTime
    
  </sql>
 
    <sql id ="Category_WhereStatement">
	 <if test="categoryNo != null  and  categoryNo  != 0"> AND categoryNo = #{categoryNo} </if>
	 <if test="categoryCode != null  and  categoryCode  != 0"> AND categoryCode = #{categoryCode} </if>
	 <if test="parentCategoryNo != null  and  parentCategoryNo  != 0"> AND parentCategoryNo = #{parentCategoryNo} </if>
	 <if test="categoryLevel != null  and  categoryLevel  != 0"> AND categoryLevel = #{categoryLevel} </if>
	 <if test="categoryName != null  and  categoryName  != 0"> AND categoryNo = #{categoryName} </if>
	 <if test="categoryNameEn != null  and  categoryNameEn  != 0"> AND categoryNameEn = #{categoryNameEn} </if>
	 <if test="categoryStatus != null  and  categoryStatus  != 0"> AND categoryStatus = #{categoryStatus} </if>

	</sql>

    <sql id ="CategoryCommand_WhereStatement">
	 <if test="categoryNo != null  and  categoryNo  != 0"> AND C1.categoryNo = #{categoryNo} </if>
	 <if test="categoryCode != null  and  categoryCode  != 0"> AND C1.categoryCode = #{categoryCode} </if>
	 <if test="parentCategoryNo != null  and  parentCategoryNo  != 0"> AND C1.parentCategoryNo = #{parentCategoryNo} </if>
	 <if test="categoryLevel != null  and  categoryLevel  != 0"> AND C1.categoryLevel = #{categoryLevel} </if>
	 <if test="categoryName != null  and  categoryName  != 0"> AND C1.categoryName= #{categoryName} </if>
	 <if test="categoryNameEn != null  and  categoryNameEn  != 0"> AND C1.categoryNameEn = #{categoryNameEn} </if>
	 <if test="categoryStatus != null  and  categoryStatus  != 0"> AND C1.categoryStatus = #{categoryStatus} </if>

	</sql>
	
    <select id="findCategories" parameterType="com.returnp.admin.model.Category"  resultMap="Category_ResultMap" >
    select 
    	<include refid="Category_Column_List" />
    from category as C1 
    where 
    	1 = 1
    	<include refid = "Category_WhereStatement"/>
  </select>
  
   <select id="findCategoryCommands" parameterType="com.returnp.admin.dto.command.CategoryCommand"  resultMap="CategoryCommand_ResultMap" >
    select 
    	<include refid="CategoryCommand_Column_List" />
    from category as C1 
    left outer join category as C2 on ( C1.parentCategoryNo =C2.categoryNo)
    where 
    	1 = 1
    	<include refid = "CategoryCommand_WhereStatement"/>
  </select>
  
  
   <delete id="deleteCategory" parameterType="com.returnp.admin.model.Category">
    delete from category
    where 
    	1 =1 
    <include refid = "Category_WhereStatement"/>
  </delete>
  
   
  <!-- ===============================================================================================================    -->
     <!-- PointTransferTransactionCommand-->
    <resultMap id="PointTransferTransactionCommand_ResultMap" type="com.returnp.admin.dto.command.PointTransferTransactionCommand">
    <id column="pointTransferTransactionNo" jdbcType="INTEGER" property="pointTransferTransactionNo" />
    <result column="pointTransferer" jdbcType="INTEGER" property="pointTransferer" />
    <result column="pointTransfererName" jdbcType="VARCHAR" property="pointTransfererName" />
    <result column="pointTransfererEmail" jdbcType="VARCHAR" property="pointTransfererEmail" />
    <result column="pointReceiver" jdbcType="INTEGER" property="pointReceiver" />
    <result column="pointReceiverName" jdbcType="VARCHAR" property="pointReceiverName" />
    <result column="pointTransferAmount" jdbcType="REAL" property="pointTransferAmount" />
    <result column="pointNode" jdbcType="VARCHAR" property="pointNode" />
    <result column="pointType" jdbcType="VARCHAR" property="pointType" />
    <result column="pointTransferType" jdbcType="VARCHAR" property="pointTransferType" />
    <result column="pointTransferStatus" jdbcType="VARCHAR" property="pointTransferStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
   <sql id="PointTransferTransactionCommand_Column_List">
    PTT.pointTransferTransactionNo, 
    PTT.pointTransferer, 
    PTT.pointReceiver, 
    PTT.pointTransferAmount, 
    PTT.pointNode,
    PTT.pointType, 
    PTT.pointTransferType, 
    PTT.pointTransferStatus, 
    PTT.createTime, 
    PTT.updateTime,
    M.memberName as pointTransfererName,
    M.memberEmail as pointTransfererEmail,
    M2.memberName as pointReceiverName
  </sql>
 
 
    <sql id ="PointTransferTransactionCommand_WhereStatement">
 	<if test="pointTransferTransactionNo != null  and  pointTransferTransactionNo  != 0"> AND pointTransferTransactionNo = #{pointTransferTransactionNo} </if>
 	<if test="pointTransferer != null "> AND pointTransferer = #{pointTransferer} </if>
 	<if test="pointReceiver != null "> AND pointReceiver = #{pointReceiver} </if>
	<if test="pointNode  != null "> AND pointNode= #{pointNode} </if>
	<if test="pointTransferStatus  != null "> AND pointTransferStatus= #{pointTransferStatus} </if>
	<if test="pointTransfererName  != null "> AND pointTransfererName= #{pointTransfererName} </if>
	<if test="pointTransfererEmail  != null "> AND pointTransfererEmail= #{pointTransfererEmail} </if>
	<if test="pointReceiverName  != null "> AND pointReceiverName= #{pointReceiverName} </if>
	<if test="pointTransferType  != null"> AND pointTransferType= #{pointTransferType} </if>
	</sql>
	
 <select id="findPointTransferTransactionCommands" parameterType="com.returnp.admin.dto.command.PointTransferTransactionCommand"  resultMap="PointTransferTransactionCommand_ResultMap" >
    select 
    	<include refid="PointTransferTransactionCommand_Column_List" />
    from point_transfer_transaction as PTT 
    inner join member as M  on (PTT.pointTransferer = M.memberNo)
    inner join member as M2  on (PTT.pointReceiver = M2.memberNo)
    where 
    	1 = 1
    	<include refid = "PointTransferTransactionCommand_WhereStatement"/>
  </select>
  
    <!-- ===============================================================================================================    -->
     <!-- code -->
  <resultMap id="Code_ResultMap" type="com.returnp.admin.model.Code">
    <id column="codeNo" jdbcType="INTEGER" property="codeNo" />
    <result column="groupCode" jdbcType="VARCHAR" property="groupCode" />
    <result column="groupCodeName" jdbcType="VARCHAR" property="groupCodeName" />
    <result column="code" jdbcType="VARCHAR" property="code" />
    <result column="codeValue" jdbcType="VARCHAR" property="codeValue" />
    <result column="codeName" jdbcType="VARCHAR" property="codeName" />
    <result column="adminUseStatus" jdbcType="CHAR" property="adminUseStatus" />
    <result column="webUseStatus" jdbcType="CHAR" property="webUseStatus" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  
  <sql id="Code_Column_List">
    codeNo, groupCode, groupCodeName, code, codeValue, codeName, adminUseStatus, webUseStatus, createTime, updateTime 
  </sql>
 
   <sql id ="Code_WhereStatement">
     <if test="groupCode != null"> AND groupCode = #{groupCode,jdbcType=VARCHAR} </if>
      <if test="groupCodeName != null"> AND groupCodeName = #{groupCodeName,jdbcType=VARCHAR}</if>
      <if test="code != null"> AND code = #{code,jdbcType=VARCHAR}</if>
      <if test="codeValue != null"> AND codeValue = #{codeValue,jdbcType=VARCHAR}</if>
      <if test="codeName != null"> AND codeName = #{codeName,jdbcType=VARCHAR}</if>
      <if test="adminUseStatus != null"> AND adminUseStatus = #{adminUseStatus,jdbcType=CHAR}</if>
      <if test="webUseStatus != null"> AND webUseStatus = #{webUseStatus,jdbcType=CHAR}</if>
	</sql>
	 
   <select id="findCodes" parameterType="com.returnp.admin.model.Code"  resultMap="Code_ResultMap" >
    select 
    	<include refid="Code_Column_List" />
    from code
    where 
    	1 = 1
    	<include refid = "Code_WhereStatement"/>
  </select>
  
    <!-- ===============================================================================================================    -->
     <!--Board -->
   <resultMap id="Board_ResultMap" type="com.returnp.admin.model.Board">
  <id column="boardNo" jdbcType="INTEGER" property="boardNo" />
    <result column="boardType" jdbcType="VARCHAR" property="boardType" />
    <result column="boardName" jdbcType="VARCHAR" property="boardName" />
    <result column="boardTitle" jdbcType="VARCHAR" property="boardTitle" />
    <result column="boardWriterNo" jdbcType="INTEGER" property="boardWriterNo" />
    <result column="boardWriterName" jdbcType="VARCHAR" property="boardWriterName" />
    <result column="boardWriterEmail" jdbcType="VARCHAR" property="boardWriterEmail" />
    <result column="boardWriterType" jdbcType="VARCHAR" property="boardWriterType" />
    <result column="viewHitCount" jdbcType="INTEGER" property="viewHitCount" />
    <result column="isPublic" jdbcType="CHAR" property="isPublic" />
    <result column="boardPid" jdbcType="INTEGER" property="boardPid" />
    <result column="boardRef" jdbcType="INTEGER" property="boardRef" />
    <result column="boardLevel" jdbcType="INTEGER" property="boardLevel" />
    <result column="boardCate" jdbcType="VARCHAR" property="boardCate" />
    <result column="replyStatus" jdbcType="VARCHAR" property="replyStatus" />
    <result column="rerv1" jdbcType="VARCHAR" property="rerv1" />
    <result column="rerv2" jdbcType="VARCHAR" property="rerv2" />
    <result column="rerv3" jdbcType="VARCHAR" property="rerv3" />
    <result column="rerv4" jdbcType="VARCHAR" property="rerv4" />
    <result column="rerv5" jdbcType="VARCHAR" property="rerv5" />
    <result column="rerv6" jdbcType="VARCHAR" property="rerv6" />
    <result column="rerv7" jdbcType="VARCHAR" property="rerv7" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
 
 <resultMap extends="Board_ResultMap" id="Board_ResultMapWithBLOBs" type="com.returnp.admin.model.Board">
		<result column="boardContent" jdbcType="LONGVARCHAR" property="boardContent" />
</resultMap>

  <sql id="Board_Column_List">
    boardNo, boardType, boardName, boardTitle, boardWriterNo, boardWriterName, boardWriterEmail, 
    boardWriterType, viewHitCount, isPublic, boardPid, boardRef, boardLevel, boardCate, 
    replyStatus, rerv1, rerv2, rerv3, rerv4, rerv5, rerv6, rerv7, createTime, updateTime
  </sql>
 
 <sql id="Board_Blob_Column_List">
		boardContent
		
	</sql>
	
   <sql id ="Board_WhereStatement">
   		<if test="boardType != null"> AND  boardType = #{boardType,jdbcType=VARCHAR}</if>
      <if test="boardName != null"> AND boardName = #{boardName,jdbcType=VARCHAR}</if>
      <if test="boardTitle != null"> AND boardTitle = #{boardTitle,jdbcType=VARCHAR}</if>
       <if test="boardPid != null"> AND boardPid = #{boardPid,jdbcType=INTEGER}</if>
      <if test="boardWriterNo != null"> AND boardWriterNo = #{boardWriterNo,jdbcType=INTEGER}</if>
      <if test="boardWriterName != null"> AND boardWriterName = #{boardWriterName,jdbcType=VARCHAR}</if>
      <if test="boardWriterEmail != null"> AND boardWriterEmail = #{boardWriterEmail,jdbcType=VARCHAR}</if>
      <if test="boardWriterType != null"> AND boardWriterType = #{boardWriterType,jdbcType=VARCHAR}</if>
      <if test="viewHitCount != null"> AND viewHitCount = #{viewHitCount,jdbcType=INTEGER}</if>
      <if test="isPublic != null"> AND isPublic = #{isPublic,jdbcType=CHAR}</if>
      <if test="boardRef != null"> AND boardRef = #{boardRef,jdbcType=INTEGER}</if>
      <if test="boardLevel != null"> AND boardLevel = #{boardLevel,jdbcType=INTEGER}</if>
      <if test="boardCate != null"> AND boardCate = #{boardCate,jdbcType=VARCHAR}</if>
      <if test="replyStatus != null"> AND replyStatRus = #{replyStatus,jdbcType=VARCHAR}</if>
      <if test="rerv1 != null"> AND rerv1 = #{rerv1,jdbcType=VARCHAR}</if>
      <if test="rerv2 != null"> AND rerv2 = #{rerv2,jdbcType=VARCHAR}</if>
      <if test="rerv3 != null"> AND rerv3 = #{rerv3,jdbcType=VARCHAR}</if>
      <if test="rerv4 != null"> AND rerv4 = #{rerv4,jdbcType=VARCHAR}</if>
      <if test="rerv5 != null"> AND rerv5 = #{rerv5,jdbcType=VARCHAR} </if>
      <if test="rerv6 != null"> AND rerv6 = #{rerv6,jdbcType=VARCHAR} </if>
      <if test="rerv7 != null"> AND rerv7 = #{rerv7,jdbcType=VARCHAR} </if>
	</sql>
	
   <select id="findBoards" parameterType="com.returnp.admin.model.Board"  resultMap="Board_ResultMapWithBLOBs" >
    select 
    	<include refid="Board_Column_List" />
    		,
		<include refid="Board_Blob_Column_List" />
    from board
    where 
    	1 = 1
    	<include refid = "Board_WhereStatement"/> 
    	ORDER by boardRef DESC , boardLevel ASC
  </select>
  
    <!-- ===============================================================================================================    -->
     <!--Board -->
  <resultMap id="Admin_File_ResultMap" type="com.returnp.admin.model.AdminFile">
    <id column="adminFileNo" jdbcType="INTEGER" property="adminFileNo" />
    <result column="uploadType" jdbcType="VARCHAR" property="uploadType" />
    <result column="fileNodeType" jdbcType="VARCHAR" property="fileNodeType" />
    <result column="fileName" jdbcType="VARCHAR" property="fileName" />
    <result column="orginalFileName" jdbcType="VARCHAR" property="orginalFileName" />
    <result column="fileLocalPath" jdbcType="VARCHAR" property="fileLocalPath" />
    <result column="fileWebPath" jdbcType="VARCHAR" property="fileWebPath" />
    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="regAdminEmail" jdbcType="VARCHAR" property="regAdminEmail" />
  </resultMap>
 
  <sql id="Admin_File_Column_List">
    adminFileNo, uploadType, fileNodeType, fileName, orginalFileName, fileLocalPath, 
    fileWebPath, createTime, updateTime, regAdminEmail
  </sql>

   <sql id ="Admin_File_WhereStatement"> </sql>
	
   <select id="findAdminFiles" parameterType="com.returnp.admin.model.AdminFile"  resultMap="Admin_File_ResultMap" >
    select 
    	<include refid="Admin_File_Column_List" />
    from admin_file
    where 
    	1 = 1
    	<include refid = "Admin_File_WhereStatement"/> 
    	ORDER by createTime DESC
  </select>
  
  <!-- ===============================================================================================================    -->
   <!-- 노드 트리 -->
 <select id="selectDirectNodes"  parameterType="hashMap" resultType="hashMap" >
 	<![CDATA[ 
 	/* param - 1.일반회원 2.정회원 3.지사 4.대리점 5.협력업체 7.총판 not null */
 	set @node_type := #{nodeType};    
 	/* param - 3.지사 4.대리점 5.협력업체 7.총판 (없을시 null) */
   set @node_no := #{nodeNo};     
    /* param - 회원번호(없을시 null)*/
   set @member_no := #{memberNo}; 
    
    /* ex) node_type=2, node_no=1, member_no=1 : 정회원인 1번회원이 1번협력업체에서 포인트발생 - 모든 상위노드 존재. */
    /* ex) node_type=2, node_no=null, member_no=1 : 정회원인 1번회원이 포인트발생 - 상위노드없음.  */
    /* ex) node_type=5, node_no=1, member_no=null : 1번 협력업체에서 포인트발생 - 대리점,지사,총판 상위노드존재. */
    /* ex) node_type=4, node_no=1, member_no=null : 1번 대리점에서 포인트발생-지사,총판 상위노드존재. */
    /* ex) node_type=3, node_no=1, member_no=null : 1번 지사에서 포인트발생- 총판 상위노드존재. */
    /* ex) node_type=7, node_no=1, member_no=null : 1번 총판에서 단독 포인트발생- 상위노드없음.  */
    /* ex) 값이 없는 경우 는 NULL 로 전달해 주어야 함 
    
   set @node_id := concat(case when @node_type< 3 then '5' else @node_type end,'-',@node_no);
   set @L := 0;
    
   select node_type,node_no,up_node_no,recommenderNo, saleManagerNo from(
   select * from node_tree where node_id in(
      select _node_id from(   
         SELECT @node_id AS _node_id,         
               (SELECT @node_id := up_node_id FROM node_tree WHERE node_id = _node_id) AS upper_id, 
               (@L := @L + 1) AS depth
         FROM node_tree AS h
         WHERE @node_id is not null
      )a
    )
    and @node_no is not null
   union all      
   select case when isRecommender='Y' then '2' else '1' end node_type,   concat(case when isRecommender='Y' then '2' else '1' end,'-', a.memberNo) node_id,   @node_id up_node_id,a.memberNo, @node_no, memberName name , a.recommenderNo, saleManagerNo  from member a left outer join recommender b on a.recommenderNo = b.recommenderNo
   where a.memberNo=@member_no
    and @node_type in (1,2)
    and @node_type = case when isRecommender='Y' then '2' else '1' end 
    )a
    ]]> 
 </select>  
 
  <!-- ===============================================================================================================    -->
     <!--MemberBankAccount -->
	<resultMap id="Member_Bank_Account_ResultMap" type="com.returnp.admin.model.MemberBankAccount">
	   <id column="memberBankAccountNo" jdbcType="INTEGER" property="memberBankAccountNo" />
	    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
	    <result column="bankName" jdbcType="VARCHAR" property="bankName" />
	    <result column="accountOwner" jdbcType="VARCHAR" property="accountOwner" />
	    <result column="bankAccount" jdbcType="VARCHAR" property="bankAccount" />
	    <result column="accountStatus" jdbcType="VARCHAR" property="accountStatus" />
	    <result column="statusMessage" jdbcType="VARCHAR" property="statusMessage" />
	    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
	    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
	    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
	     <result column="regType" jdbcType="CHAR" property="regType" />
	  </resultMap>
	  
	 <resultMap id="Member_Bank_Account_Command_ResultMap" type="com.returnp.admin.dto.command.MemberBankAccountCommand">
	    <id column="memberBankAccountNo" jdbcType="INTEGER" property="memberBankAccountNo" />
	    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
	    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
	    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
	    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
	    <result column="bankName" jdbcType="VARCHAR" property="bankName" />
	    <result column="accountOwner" jdbcType="VARCHAR" property="accountOwner" />
	    <result column="bankAccount" jdbcType="VARCHAR" property="bankAccount" />
	    <result column="accountStatus" jdbcType="VARCHAR" property="accountStatus" />
	    <result column="statusMessage" jdbcType="VARCHAR" property="statusMessage" />
	    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
	    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
	    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
	     <result column="regType" jdbcType="CHAR" property="regType" />
   </resultMap>
 
  <sql id="Member_Bank_Account_Columns">
    memberBankAccountNo, memberNo, bankName, accountOwner, bankAccount, accountStatus, statusMessage, createTime, updateTime, regAdminNo,regType
  </sql>
  
   <sql id="Member_Bank_Account_Command_Columns">
    MA.memberBankAccountNo, 
    MA.memberNo, 
    M.memberName, 
    M.memberEmail, 
    M.memberPhone, 
    MA.bankName, 
    MA.accountOwner, 
    MA.bankAccount, 
    MA.accountStatus, 
    MA.statusMessage, 
    MA.createTime, 
    MA.updateTime, 
    MA.regAdminNo,
    MA.regType
  </sql>

   <sql id ="Member_Bank_Account_WhereStatement">
   	  <if test="memberBankAccountNo!= null"> AND  MA.memberBankAccountNo = #{memberBankAccountNo,jdbcType=INTEGER}</if>
   	  <if test="memberNo != null"> AND  MA.memberNo = #{memberNo,jdbcType=INTEGER}</if>
      <if test="accountOwner != null"> AND MA.accountOwner = #{accountOwner,jdbcType=VARCHAR}</if>
      <if test="accountStatus != null"> AND MA.accountStatus = #{accountStatus,jdbcType=VARCHAR}</if>
   </sql>
  
   <select id="findMemberBankAccounts" parameterType="com.returnp.admin.model.MemberBankAccount"  resultMap="Member_Bank_Account_ResultMap" >
    	select 
    		<include refid="Member_Bank_Account_Columns" />
    	from member_bank_account
   		where 
    		1 = 1
    		<include refid = "Member_Bank_Account_WhereStatement"/> 
    	ORDER by createTime DESC
  </select>
  
  <select id="findMemberBankAccountCommands" parameterType="com.returnp.admin.model.MemberBankAccount"  resultMap="Member_Bank_Account_Command_ResultMap" >
    	select 
    		<include refid="Member_Bank_Account_Command_Columns" />
    	from member_bank_account as MA
    	inner join member as M  on (MA.memberNo = M.memberNo)
   		where 
    		1 = 1
    		<include refid = "Member_Bank_Account_WhereStatement"/> 
    	ORDER by createTime DESC
  </select>
  
    <!-- ===============================================================================================================    -->
     <!--PointWithdrawal -->
	<resultMap id="Point_Withdrawal_ResultMap" type="com.returnp.admin.model.PointWithdrawal">
	    <id column="pointWithdrawalNo" jdbcType="INTEGER" property="pointWithdrawalNo" />
	    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
	    <result column="memberBankAccountNo" jdbcType="INTEGER" property="memberBankAccountNo" />
	    <result column="withdrawalAmount" jdbcType="INTEGER" property="withdrawalAmount" />
	    <result column="withdrawalStatus" jdbcType="VARCHAR" property="withdrawalStatus" />
	    <result column="withdrawalPointType" jdbcType="VARCHAR" property="withdrawalPointType" />
	    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
	     <result column="regType" jdbcType="CHAR" property="regType" />
	    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
	    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
	  </resultMap>
	  
	<resultMap id="Point_Withdrawal_Command_ResultMap" type="com.returnp.admin.dto.command.PointWithdrawalCommand">
	    <id column="pointWithdrawalNo" jdbcType="INTEGER" property="pointWithdrawalNo" />
	    <result column="memberNo" jdbcType="INTEGER" property="memberNo" />
	    <result column="memberBankAccountNo" jdbcType="INTEGER" property="memberBankAccountNo" />
	    <result column="withdrawalAmount" jdbcType="INTEGER" property="withdrawalAmount" />
	    <result column="withdrawalStatus" jdbcType="VARCHAR" property="withdrawalStatus" />
	    <result column="withdrawalPointType" jdbcType="VARCHAR" property="withdrawalPointType" />
	    <result column="memberName" jdbcType="VARCHAR" property="memberName" />
	    <result column="memberEmail" jdbcType="VARCHAR" property="memberEmail" />
	    <result column="memberPhone" jdbcType="VARCHAR" property="memberPhone" />
	    <result column="bankName" jdbcType="VARCHAR" property="bankName" />
	    <result column="accountOwner" jdbcType="VARCHAR" property="accountOwner" />
	    <result column="bankAccount" jdbcType="VARCHAR" property="bankAccount" />
	    <result column="regAdminNo" jdbcType="INTEGER" property="regAdminNo" />
	     <result column="regType" jdbcType="CHAR" property="regType" />
	    <result column="createTime" jdbcType="TIMESTAMP" property="createTime" />
	    <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
	  </resultMap>
 
  <sql id="Point_Withdrawal_Blob_Column_List">
    withdrawalMessage
  </sql>
  
  <sql id="Point_Withdrawal_Columns">
    pointWithdrawalNo, memberNo, memberBankAccountNo, withdrawalAmount, withdrawalStatus, 
    withdrawalPointType, regAdminNo, regType, createTime, updateTime
  </sql>
  
   <sql id="Point_Withdrawal_Command_Columns">
    PW.pointWithdrawalNo, 
    PW.memberNo, 
    PW.memberBankAccountNo, 
    PW.withdrawalAmount, 
    PW.withdrawalStatus, 
    PW.withdrawalPointType, 
    PW.regAdminNo, 
    PW.regType, 
    M.memberName, 
    M.memberEmail, 
    M.memberPhone, 
    MBA.bankName, 
    MBA.accountOwner, 
    MBA.bankAccount, 
    PW.createTime, 
    PW.updateTime
  </sql>

   <sql id ="Point_Withdrawal_WhereStatement">
      <if test="memberNo != null"> AND  memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="pointWithdrawalNo != null"> AND  pointWithdrawalNo = #{pointWithdrawalNo,jdbcType=INTEGER} </if>
      <if test="memberBankAccountNo != null"> AND   memberBankAccountNo = #{memberBankAccountNo,jdbcType=INTEGER} </if>
      <if test="withdrawalAmount != null"> AND  withdrawalAmount = #{withdrawalAmount,jdbcType=INTEGER} </if>
      <if test="withdrawalStatus != null"> AND  withdrawalStatus = #{withdrawalStatus,jdbcType=VARCHAR} </if>
      <if test="withdrawalPointType != null"> AND  withdrawalPointType = #{withdrawalPointType,jdbcType=VARCHAR} </if>
   </sql>
   
   <sql id ="Point_Withdrawal_Command_WhereStatement">
      <if test="memberNo != null"> AND  memberNo = #{memberNo,jdbcType=INTEGER} </if>
      <if test="pointWithdrawalNo != null"> AND   pointWithdrawalNo = #{pointWithdrawalNo,jdbcType=INTEGER} </if>
      <if test="memberBankAccountNo != null"> AND   memberBankAccountNo = #{memberBankAccountNo,jdbcType=INTEGER} </if>
      <if test="withdrawalStatus != null"> AND  withdrawalStatus = #{withdrawalStatus,jdbcType=VARCHAR} </if>
      <if test="withdrawalPointType != null"> AND  withdrawalPointType = #{withdrawalPointType,jdbcType=VARCHAR} </if>
      <if test="memberName != null"> AND  memberName = #{memberName,jdbcType=VARCHAR} </if>
      <if test="memberEmail != null"> AND  memberEmail = #{memberEmail,jdbcType=VARCHAR} </if>
      <if test="memberPhone != null"> AND  memberPhone = #{memberPhone,jdbcType=VARCHAR} </if>
   </sql>
   
  
   <select id="findPointWithdrawals" parameterType="com.returnp.admin.model.PointWithdrawal"  resultMap="Point_Withdrawal_ResultMap" >
    	select 
    		<include refid="Point_Withdrawal_Columns" />
    		,
    		<include refid="Point_Withdrawal_Blob_Column_List" />
    	from point_withdrawal
   		where 
    		1 = 1
    		<include refid = "Point_Withdrawal_WhereStatement"/> 
    	ORDER by createTime DESC
  </select>
  
   <select id="findPointWithdrawalCommands" parameterType="com.returnp.admin.dto.command.PointWithdrawalCommand"  resultMap="Point_Withdrawal_Command_ResultMap" >
    	select 
    		<include refid="Point_Withdrawal_Command_Columns" />
    		,
    		<include refid="Point_Withdrawal_Blob_Column_List" />
    	from point_withdrawal as PW
    	inner join member as M  on (PW.memberNo = M.memberNo)
    	inner join member_bank_account as MBA  on (PW.memberBankAccountNo = MBA.memberBankAccountNo)
   		where 
    		1 = 1
    		<include refid = "Point_Withdrawal_Command_WhereStatement"/> 
    	ORDER by createTime DESC
  </select>
</mapper>
 
